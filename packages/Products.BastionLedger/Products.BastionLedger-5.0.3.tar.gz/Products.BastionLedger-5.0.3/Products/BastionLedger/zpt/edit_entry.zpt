<html tal:replace="structure context/manage_page_header"/>
     <span tal:replace="structure context/manage_tabs"/>

      <br/>

      <form name="form" action="" tal:attributes="action request/URL1" method="post"
            tal:define="control context/isControlEntry;
                        effective python: control and context.lastControlDate() or context.effective();
                        txn context/blTransaction">

         <table cellspacing="0" cellpadding="2" border="0">
           <tr>
                  <td class="form-label">Id</td>
                  <td class="form-element">
                     <a href="" tal:condition="nocall: txn"
                        tal:attributes="href string:${txn/absolute_url}/manage_workspace"
                        tal:content="context/getId"/>
                     <span tal:condition="python: not txn" tal:replace="context/getId"/>
                  </td>
           </tr>
           <tr>
                  <td class="form-label">Effective Date</td>
                  <td class="form-element" tal:content="effective"/>
           </tr>
           <tr>
                  <td class="form-label">Description</td>
                  <td class="form-element">
                      <input type="text" size="50" name="title" 
                             tal:attributes="value request/title | context/title"/>
                  </td>
           </tr>
           <tr>
                  <td class="form-label">Account</td>
                  <td class="form-element" tal:define="account context/blAccount">
                      <a href="" tal:condition="nocall: account" 
                         tal:attributes="href string:${account/absolute_url}/manage_workspace"
                         tal:content="account/prettyTitle"/>
                      <span tal:condition="python: not account" tal:replace="context/account"/>
                  </td>
           </tr>
           <tr>
                  <td class="form-label">Amount</td>
                  <td class="form-element">
                      <input tal:condition="not: control" type="text" size="12" name="amount:currency" 
                             tal:attributes="value request/amount | context/amount"/>
                      <span tal:condition="control" tal:replace="context/amount"/>
                  </td>
           </tr>
           <tr tal:condition="nocall: txn">
                  <td class="form-label">Transaction</td>
                  <td class="form-element">
                      <a href="" tal:attributes="href string: ${txn/absolute_url}/manage_workspace"
                                 tal:content="txn/getId"/>
                  </td>
           </tr>
           <tr tal:condition="control">
                  <td class="form-label">Ledger</td>
                  <td class="form-element" tal:define="ledger context/blLedger">
                      <a href="" tal:attributes="href string: ${ledger/absolute_url}/manage_workspace"
                                 tal:content="ledger/Title"/>
                  </td>
           </tr>
           <tr tal:define="ref context/reference">
                  <td class="form-label">Reference</td>
                  <td class="form-element" tal:define="anchor python: getattr(ref, 'meta_type', None)">
                      <span tal:condition="not: anchor" tal:content="ref"/>
                      <a tal:condition="anchor" tal:content="ref/getId"
                         tal:attributes="href python: '%s/manage_workspace' % ref.absolute_url(1)"/><br/>
                      <input type="text" size="50" name="ref" value="" tal:attributes="value request/ref | context/ref"/>
                  </td>
           </tr>
           <tr>
                  <td class="form-label">FX Conversion Rate</td>
                  <td class="form-element">
                       <input type="text" name="fx_rate:float" size="6"
                              tal:attributes="value request/fx_rate | context/fx_rate | nothing"/>
                  </td>
            </tr>
            <tr>
                  <td class="form-label">Posted Amount</td>
                  <td class="form-element" tal:content="context/foreignAmount | nothing"/>
            </tr>
            <tr>
                  <td class="form-label">Status</td>
                  <td class="form-element" tal:content="context/status" tal:on-error="string:N/a"/>
            </tr>
           <tr>
                 <td class="form-element">
                       <input type="submit" name="manage_edit:method" value="   Edit   ">
                 </td>
                 <td align="right" class="form-element" tal:condition="control">
                       <input type="text" name="effective:date:ignore_empty" size="16" value=""
                              tal:attributes="value python: effective.strftime('%Y/%m/%d')"/>
                       <input type="submit" name="manage_recalculate:method" value="Recalculate"/>
                 </td>
           </tr>
      </table>
    </form>

    <form name="remove" action="" tal:attributes="action request/URL1" method="post"
          tal:condition="exists: context/posted_amount">
        <input type="submit" class="form-element" name="manage_removePosting:method" 
               value=" Remove Posted Amount ">
    </form>

<html tal:replace="structure context/manage_page_footer"/>




