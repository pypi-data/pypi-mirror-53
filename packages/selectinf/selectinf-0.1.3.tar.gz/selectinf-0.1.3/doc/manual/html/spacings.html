

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Selection &mdash; Selection Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Selection documentation attribution" href="docattribute.html" />


</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Selection documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="docattribute.html">Selection documentation attribution</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The spacings test</a></li>
<li class="toctree-l1"><a class="reference internal" href="#spacings-test">Spacings test</a></li>
<li class="toctree-l1"><a class="reference internal" href="#spacings-in-a-regression-setting">Spacings in a regression setting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#covariance-test-for-forward-stepwise">Covariance test for forward stepwise</a></li>
<li class="toctree-l2"><a class="reference internal" href="#null-behavior">Null behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sparse-model">1-sparse model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">2-sparse model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">5-sparse model</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Selection documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">selection</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Selection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/spacings.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-spacings-test">
<h1>The spacings test<a class="headerlink" href="#the-spacings-test" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference external" href="covtest.html">covariance test</a> describes the distribution of
spacings at points on the LARS path for the LASSO (see <a class="reference external" href="http://arxiv.org/abs/1301.7161">the
paper</a>).</p>
<p>It is an asymptotic distribution for the “first null step” that LARS
takes. That is, if there are 5 strong variables in the model, the 6th
<code class="docutils literal notranslate"><span class="pre">covtest</span></code> <span class="math notranslate nohighlight">\(p\)</span>-value should be approximately uniform on [0,1].</p>
<p>Before the 6th step, we expect (or hope) to see low p-values, but what
about after the 6th step? In the paper, it is pointed out that in the
orthogonal case, the subsequent steps look like Exp random variables
with means depending on how far beyond the “first null” we are.</p>
<p>Here is an illustration of this phenomenon in the orthogonal case, for
which we expect</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
T_{(k+5)} &amp;= Z_{(k+5)} (Z_{(k+5)} - Z_{(k+6)}) \\
&amp; \approx \text{Exp}(1/k).
\end{aligned}\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">statsmodels.distributions</span> <span class="kn">import</span> <span class="n">ECDF</span>
<span class="kn">from</span> <span class="nn">selection.covtest</span> <span class="kn">import</span> <span class="n">covtest</span>
</pre></div>
</div>
<p>We will sample 2000 times from <span class="math notranslate nohighlight">\(Z \sim N(\mu,I_{100 \times 100})\)</span>
and look at the normalized spacing between the top 2 values. The mean
vector <span class="math notranslate nohighlight">\(\mu\)</span> will be sparse, with 5 large values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="mi">2000</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">Z</span><span class="p">[:,:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="mi">6</span><span class="p">])[</span><span class="bp">None</span><span class="p">,:]</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2000</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="n">covtest_fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">Ugrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ugrid</span><span class="p">,</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]))(</span><span class="n">Ugrid</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;covtest&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Step </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/spacings_4_0.png" src="_images/spacings_4_0.png" />
<p>Knowing there are 5 strong signals, we can apply the approximation about
the exponentials of different sizes to the later steps. The last 4
p-values now all seem roughly uniform on (0,1)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">T</span> <span class="o">*=</span> <span class="n">factor</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ugrid</span><span class="p">,</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]))(</span><span class="n">Ugrid</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;covtest corrected&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">covtest_fig</span>
</pre></div>
</div>
<img alt="_images/spacings_6_0.png" src="_images/spacings_6_0.png" />
</div>
<div class="section" id="spacings-test">
<h1>Spacings test<a class="headerlink" href="#spacings-test" title="Permalink to this headline">¶</a></h1>
<p>The <a href="#id3"><span class="problematic" id="id4">`spacings test &lt;&gt;`__</span></a> does not show this same behaviour at later
stages of the path, as it keeps track of the order of the variables that
have “entered” the model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span> <span class="k">as</span> <span class="n">ndist</span>
<span class="n">spacings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2000</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2000</span><span class="p">):</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">i</span><span class="p">])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">spacings</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">ndist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">ndist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span> <span class="o">/</span>
                             <span class="p">(</span><span class="n">ndist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">ndist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">spacings</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">/</span> <span class="n">ndist</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ugrid</span><span class="p">,</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">spacings</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])(</span><span class="n">Ugrid</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;spacings&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">covtest_fig</span>
</pre></div>
</div>
<img alt="_images/spacings_9_0.png" src="_images/spacings_9_0.png" />
</div>
<div class="section" id="spacings-in-a-regression-setting">
<h1>Spacings in a regression setting<a class="headerlink" href="#spacings-in-a-regression-setting" title="Permalink to this headline">¶</a></h1>
<p>The spacings test can be used in a regression setting as well. The
<a class="reference external" href="http://arxiv.org/abs/1401.3889">spacings paper</a> describes this
approach for the LARS path, though it can also be used in other
contexts.</p>
<p>Below, we use it in forward stepwise model selection.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">nsim</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">1.5</span>

<span class="k">def</span> <span class="nf">instance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">))</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)[:,</span><span class="bp">None</span><span class="p">])</span>
    <span class="n">X</span> <span class="o">-=</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="bp">None</span><span class="p">,:]</span>
    <span class="n">X</span> <span class="o">/=</span> <span class="n">X</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="bp">None</span><span class="p">,:]</span>
    <span class="n">X</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span>
    <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">Y</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selection.forward_step</span> <span class="kn">import</span> <span class="n">forward_stepwise</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">FS</span> <span class="o">=</span> <span class="n">forward_stepwise</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="n">FS</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">106</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">97</span><span class="p">]</span>
</pre></div>
</div>
<p>The steps taken above should match <code class="docutils literal notranslate"><span class="pre">R</span></code>’s output. We first load the
<code class="docutils literal notranslate"><span class="pre">%R</span></code> magic.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">load_ext</span> <span class="n">rmagic</span>
</pre></div>
</div>
<p>Recall that <code class="docutils literal notranslate"><span class="pre">R</span></code> uses 1-based indexing so there will be a difference of
1 in the indexes of selected variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">model5</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">D</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="n">lm</span><span class="p">(</span><span class="n">Y</span> <span class="o">~</span> <span class="o">.</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">D</span><span class="p">)),</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">,</span>
     <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trace</span><span class="o">=</span><span class="n">FALSE</span><span class="p">)</span>
<span class="n">model5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Call</span><span class="p">:</span>
<span class="n">lm</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">~</span> <span class="n">X107</span> <span class="o">+</span> <span class="n">X79</span> <span class="o">+</span> <span class="n">X59</span> <span class="o">+</span> <span class="n">X136</span> <span class="o">+</span> <span class="n">X98</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">D</span><span class="p">)</span>

<span class="n">Coefficients</span><span class="p">:</span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>         <span class="n">X107</span>          <span class="n">X79</span>          <span class="n">X59</span>         <span class="n">X136</span>          <span class="n">X98</span>
     <span class="mf">0.1062</span>      <span class="o">-</span><span class="mf">4.1047</span>       <span class="mf">8.2780</span>      <span class="o">-</span><span class="mf">6.4041</span>       <span class="mf">6.1924</span>      <span class="o">-</span><span class="mf">4.7872</span>
</pre></div>
</div>
<div class="section" id="covariance-test-for-forward-stepwise">
<h2>Covariance test for forward stepwise<a class="headerlink" href="#covariance-test-for-forward-stepwise" title="Permalink to this headline">¶</a></h2>
<p>While the <code class="docutils literal notranslate"><span class="pre">covtest</span></code> was derived for the LASSO, it can be used
sequentially in forward stepwise as well. Consider the model</p>
<div class="math notranslate nohighlight">
\[y|X \sim N(\mu, \sigma^2 I).\]</div>
<p>The basic approach is to note that <code class="docutils literal notranslate"><span class="pre">covtest</span></code> provides, a test of the
null</p>
<div class="math notranslate nohighlight">
\[H_0 : \mu = 0\]</div>
<p>Subsequent steps essentially reapply this same test forgetting what has
happened previously. In the case of the LARS path, each addition step
can be expressed as a choice among several competing variables to add
(see <a class="reference external" href="http://arxiv.org/abs/1206.0313">uniqueness</a> and
<a class="reference external" href="http://arxiv.org/abs/1401.3889">spacings</a> for more details).</p>
<p>To use the <code class="docutils literal notranslate"><span class="pre">covtest</span></code> for forward stepwise, we orthogonalize with
respect to the variables already chosen and apply the covtest to the
residual and orthogonalized <span class="math notranslate nohighlight">\(X\)</span> matrix.</p>
<p>Specifically, denote <span class="math notranslate nohighlight">\(R_{M[j]}\)</span> the residual forming matrix at the
<span class="math notranslate nohighlight">\(j\)</span>-th step, with <span class="math notranslate nohighlight">\(R_0=I\)</span> with <span class="math notranslate nohighlight">\(M[j]\)</span> the <span class="math notranslate nohighlight">\(j\)</span>-th
model. At the <span class="math notranslate nohighlight">\(j+1\)</span>-st step, we simply compute the <code class="docutils literal notranslate"><span class="pre">covtest</span></code>
with design <span class="math notranslate nohighlight">\(R_{M[j]}X\)</span> (with normalized columns) and response
<span class="math notranslate nohighlight">\(R_{M[j]}Y\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selection.affine</span> <span class="kn">import</span> <span class="n">constraints</span>

<span class="k">def</span> <span class="nf">forward_step</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                 <span class="n">nstep</span><span class="o">=</span><span class="mi">9</span><span class="p">):</span>

    <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">FS</span> <span class="o">=</span> <span class="n">forward_stepwise</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">spacings_P</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">covtest_P</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nstep</span><span class="p">):</span>
        <span class="n">FS</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">FS</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">RX</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">FS</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">X</span><span class="p">)</span>
            <span class="n">RY</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">-</span> <span class="n">FS</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">](</span><span class="n">Y</span><span class="p">)</span>
            <span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">FS</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">RX</span> <span class="o">=</span> <span class="n">X</span>
            <span class="n">RY</span> <span class="o">=</span> <span class="n">Y</span>
            <span class="n">covariance</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">RX</span> <span class="o">-=</span> <span class="n">RX</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="bp">None</span><span class="p">,:]</span>
        <span class="n">RX</span> <span class="o">/=</span> <span class="n">RX</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="bp">None</span><span class="p">,:]</span>

        <span class="n">con</span><span class="p">,</span> <span class="n">pval</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">sign</span> <span class="o">=</span> <span class="n">covtest</span><span class="p">(</span><span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span>
                                       <span class="n">covariance</span><span class="o">=</span><span class="n">covariance</span><span class="p">,</span>
                                       <span class="n">exact</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">covtest_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pval</span><span class="p">)</span>

        <span class="c1"># spacings</span>

        <span class="n">eta</span> <span class="o">=</span> <span class="n">RX</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">sign</span>
        <span class="n">spacings_constraint</span> <span class="o">=</span> <span class="n">constraints</span><span class="p">(</span><span class="n">FS</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">FS</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">spacings_constraint</span><span class="o">.</span><span class="n">covariance</span> <span class="o">*=</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">spacings_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spacings_constraint</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">eta</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">covtest_P</span><span class="p">,</span> <span class="n">spacings_P</span>
</pre></div>
</div>
<p>The above function computes our covtest and spacings <span class="math notranslate nohighlight">\(p\)</span>-values
for several steps of forward stepwise.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">forward_step</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="mf">0.73909103381622476</span><span class="p">,</span>
  <span class="mf">0.69360763579435791</span><span class="p">,</span>
  <span class="mf">0.39906919537104235</span><span class="p">,</span>
  <span class="mf">0.81146065359168629</span><span class="p">,</span>
  <span class="mf">0.55327261959262941</span><span class="p">,</span>
  <span class="mf">0.80265701686406743</span><span class="p">,</span>
  <span class="mf">0.90884645708288014</span><span class="p">,</span>
  <span class="mf">0.99181179452730495</span><span class="p">,</span>
  <span class="mf">0.64069596746441959</span><span class="p">],</span>
 <span class="p">[</span><span class="mf">0.694095750161889</span><span class="p">,</span>
  <span class="mf">0.6513481019927231</span><span class="p">,</span>
  <span class="mf">0.3234919672656077</span><span class="p">,</span>
  <span class="mf">0.573180829314827</span><span class="p">,</span>
  <span class="mf">0.44008971114931383</span><span class="p">,</span>
  <span class="mf">0.5542519955483218</span><span class="p">,</span>
  <span class="mf">0.8596480260839896</span><span class="p">,</span>
  <span class="mf">0.9073752648845056</span><span class="p">,</span>
  <span class="mf">0.11680940361115943</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simulation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="n">covtest_P</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">spacings_P</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">instance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">_cov</span><span class="p">,</span> <span class="n">_spac</span> <span class="o">=</span> <span class="n">forward_step</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
        <span class="n">covtest_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_cov</span><span class="p">)</span>
        <span class="n">spacings_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_spac</span><span class="p">)</span>

    <span class="n">covtest_P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">covtest_P</span><span class="p">)</span>
    <span class="n">spacings_P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spacings_P</span><span class="p">)</span>

    <span class="n">regression_fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
    <span class="n">Ugrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ugrid</span><span class="p">,</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">covtest_P</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])(</span><span class="n">Ugrid</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;covtest&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Ugrid</span><span class="p">,</span> <span class="n">ECDF</span><span class="p">(</span><span class="n">spacings_P</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">])(</span><span class="n">Ugrid</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;steps&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;spacings&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Step </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">covtest_P</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spacings_P</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="null-behavior">
<h2>Null behavior<a class="headerlink" href="#null-behavior" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/spacings_25_0.png" src="_images/spacings_25_0.png" />
</div>
<div class="section" id="sparse-model">
<h2>1-sparse model<a class="headerlink" href="#sparse-model" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">beta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sigma</span>
<span class="n">simulation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/spacings_27_0.png" src="_images/spacings_27_0.png" />
</div>
<div class="section" id="id1">
<h2>2-sparse model<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">beta</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.5</span><span class="p">])</span> <span class="o">*</span> <span class="n">sigma</span>
<span class="n">simulation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/spacings_29_0.png" src="_images/spacings_29_0.png" />
</div>
<div class="section" id="id2">
<h2>5-sparse model<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">beta</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">5.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">])</span> <span class="o">*</span> <span class="n">sigma</span>
<span class="n">simulation</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/spacings_31_0.png" src="_images/spacings_31_0.png" />
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="docattribute.html" class="btn btn-neutral float-left" title="Selection documentation attribution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright J. Taylor and others
      <span class="lastupdated">
        Last updated on Sep 24, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>