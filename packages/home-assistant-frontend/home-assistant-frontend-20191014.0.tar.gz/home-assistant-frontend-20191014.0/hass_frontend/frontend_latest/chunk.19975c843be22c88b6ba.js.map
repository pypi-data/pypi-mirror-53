{"version":3,"sources":["webpack:///./src/panels/config/cloud/register/cloud-register.js"],"names":["__webpack_require__","r","__webpack_exports__","_polymer_polymer_lib_utils_html_tag__WEBPACK_IMPORTED_MODULE_1__","_polymer_polymer_polymer_element__WEBPACK_IMPORTED_MODULE_2__","_mixins_events_mixin__WEBPACK_IMPORTED_MODULE_8__","_mixins_localize_mixin__WEBPACK_IMPORTED_MODULE_9__","customElements","define","Object","template","properties","hass","isWide","Boolean","email","type","String","notify","_requestInProgress","value","_password","_error","observers","[object Object]","this","$","invalid","password","ev","keyCode","_handleRegister","preventDefault","includes","focus","length","callApi","then","_verificationEmailSent","err","setProperties","body","message","fire","flashMessage","localize"],"mappings":"uFAAAA,EAAAC,EAAAC,GAAAF,EAAA,QAAAG,EAAAH,EAAA,GAAAI,EAAAJ,EAAA,IAAAK,GAAAL,EAAA,KAAAA,EAAA,KAAAA,EAAA,KAAAA,EAAA,IAAAA,EAAA,KAAAA,EAAA,MAAAM,EAAAN,EAAA,KA8NAO,eAAAC,OAAA,iBA9MA,cAA4BC,OAAAH,EAAA,EAAAG,CAAcA,OAAAJ,EAAA,EAAAI,CAAYL,EAAA,KACtDM,sBACA,OAAWP,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAmFXQ,wBACA,OACAC,KAAAH,OACAI,OAAAC,QACAC,MAAA,CACAC,KAAAC,OACAC,QAAA,GAGAC,mBAAA,CACAH,KAAAF,QACAM,OAAA,GAEAC,UAAA,CACAL,KAAAC,OACAG,MAAA,IAEAE,OAAA,CACAN,KAAAC,OACAG,MAAA,KAKAG,uBACA,0CAGAC,gBACAC,KAAAH,OAAA,GACAG,KAAAC,EAAAX,MAAAY,SAAA,EACAF,KAAAC,EAAAE,SAAAD,SAAA,EAGAH,SAAAK,GAEA,KAAAA,EAAAC,UACAL,KAAAM,kBACAF,EAAAG,kBAIAR,kBACA,IAAAG,GAAA,EAEAF,KAAAV,OAAAU,KAAAV,MAAAkB,SAAA,OACAR,KAAAC,EAAAX,MAAAY,SAAA,EACAF,KAAAC,EAAAX,MAAAmB,QACAP,GAAA,GAGAF,KAAAJ,UAAAc,OAAA,IACAV,KAAAC,EAAAE,SAAAD,SAAA,EAEAA,IACAA,GAAA,EACAF,KAAAC,EAAAE,SAAAM,UAIAP,IAEAF,KAAAN,oBAAA,EAEAM,KAAAb,KACAwB,QAAA,yBACArB,MAAAU,KAAAV,MACAa,SAAAH,KAAAJ,YAEAgB,KACA,IAAAZ,KAAAa,yBACAC,IAEAd,KAAAJ,UAAA,GAEAI,KAAAe,cAAA,CACArB,oBAAA,EACAG,OACAiB,KAAAE,MAAAF,EAAAE,KAAAC,QACAH,EAAAE,KAAAC,QACA,qBAMAlB,2BACAC,KAAAV,MAKAU,KAAAb,KACAwB,QAAA,+BACArB,MAAAU,KAAAV,QAEAsB,KACA,IAAAZ,KAAAa,yBACAC,GACAd,KAAAe,cAAA,CACAlB,OACAiB,KAAAE,MAAAF,EAAAE,KAAAC,QACAH,EAAAE,KAAAC,QACA,mBAfAjB,KAAAC,EAAAX,MAAAY,SAAA,EAoBAH,yBACAC,KAAAe,cAAA,CACArB,oBAAA,EACAE,UAAA,KAEAI,KAAAkB,KAAA,cACAC,aAAAnB,KAAAb,KAAAiC,SACA","file":"chunk.19975c843be22c88b6ba.js","sourcesContent":["import \"@polymer/paper-input/paper-input\";\nimport { html } from \"@polymer/polymer/lib/utils/html-tag\";\nimport { PolymerElement } from \"@polymer/polymer/polymer-element\";\n\nimport \"../../../../components/ha-card\";\nimport \"../../../../components/buttons/ha-progress-button\";\nimport \"../../../../layouts/hass-subpage\";\nimport \"../../../../resources/ha-style\";\nimport \"../../ha-config-section\";\nimport { EventsMixin } from \"../../../../mixins/events-mixin\";\nimport LocalizeMixin from \"../../../../mixins/localize-mixin\";\n\n/*\n * @appliesMixin EventsMixin\n * @appliesMixin LocalizeMixin\n */\nclass CloudRegister extends LocalizeMixin(EventsMixin(PolymerElement)) {\n  static get template() {\n    return html`\n    <style include=\"iron-flex ha-style\">\n      .content {\n        direction: ltr;\n      }\n\n      [slot=introduction] {\n        margin: -1em 0;\n      }\n      [slot=introduction] a {\n        color: var(--primary-color);\n      }\n      a {\n        color: var(--primary-color);\n      }\n      paper-item {\n        cursor: pointer;\n      }\n      h1 {\n        @apply --paper-font-headline;\n        margin: 0;\n      }\n      .error {\n        color: var(--google-red-500);\n      }\n      .card-actions {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n      }\n      [hidden] {\n        display: none;\n      }\n    </style>\n    <hass-subpage header=\"[[localize('ui.panel.config.cloud.register.title')]]\">\n      <div class=\"content\">\n        <ha-config-section is-wide=\"[[isWide]]\">\n          <span slot=\"header\">[[localize('ui.panel.config.cloud.register.headline')]]</span>\n          <div slot=\"introduction\">\n            <p>\n              [[localize('ui.panel.config.cloud.register.information')]]\n            </p>\n            <p>\n            [[localize('ui.panel.config.cloud.register.information2')]]\n            </p>\n            <ul>\n              <li>[[localize('ui.panel.config.cloud.register.feature_remote_control')]]</li>\n              <li>[[localize('ui.panel.config.cloud.register.feature_google_home')]]</li>\n              <li>[[localize('ui.panel.config.cloud.register.feature_amazon_alexa')]]</li>\n              <li>[[localize('ui.panel.config.cloud.register.feature_webhook_apps')]]</li>\n            </ul>\n            <p>\n              [[localize('ui.panel.config.cloud.register.information3')]] <a href='https://www.nabucasa.com' target='_blank'>Nabu&nbsp;Casa,&nbsp;Inc</a>[[localize('ui.panel.config.cloud.register.information3a')]]\n            </p>\n\n            <p>\n              [[localize('ui.panel.config.cloud.register.information4')]]\n              </p><ul>\n                <li><a href=\"https://home-assistant.io/tos/\" target=\"_blank\">[[localize('ui.panel.config.cloud.register.link_terms_conditions')]]</a></li>\n                <li><a href=\"https://home-assistant.io/privacy/\" target=\"_blank\">[[localize('ui.panel.config.cloud.register.link_privacy_policy')]]</a></li>\n              </ul>\n            </p>\n          </div>\n\n          <ha-card header=\"[[localize('ui.panel.config.cloud.register.create_account')]]\">\n            <div class=\"card-content\">\n              <div class=\"header\">\n                <div class=\"error\" hidden$=\"[[!_error]]\">[[_error]]</div>\n              </div>\n              <paper-input autofocus=\"\" id=\"email\" label=\"[[localize('ui.panel.config.cloud.register.email_address')]]\" type=\"email\" value=\"{{email}}\" on-keydown=\"_keyDown\" error-message=\"[[localize('ui.panel.config.cloud.register.email_error_msg')]]\"></paper-input>\n              <paper-input id=\"password\" label=\"Password\" value=\"{{_password}}\" type=\"password\" on-keydown=\"_keyDown\" error-message=\"[[localize('ui.panel.config.cloud.register.password_error_msg')]]\"></paper-input>\n            </div>\n            <div class=\"card-actions\">\n              <ha-progress-button on-click=\"_handleRegister\" progress=\"[[_requestInProgress]]\">[[localize('ui.panel.config.cloud.register.start_trial')]]</ha-progress-button>\n              <button class=\"link\" hidden=\"[[_requestInProgress]]\" on-click=\"_handleResendVerifyEmail\">[[localize('ui.panel.config.cloud.register.resend_confirmation_email')]]</button>\n            </div>\n          </ha-card>\n        </ha-config-section>\n      </div>\n    </hass-subpage>\n`;\n  }\n\n  static get properties() {\n    return {\n      hass: Object,\n      isWide: Boolean,\n      email: {\n        type: String,\n        notify: true,\n      },\n\n      _requestInProgress: {\n        type: Boolean,\n        value: false,\n      },\n      _password: {\n        type: String,\n        value: \"\",\n      },\n      _error: {\n        type: String,\n        value: \"\",\n      },\n    };\n  }\n\n  static get observers() {\n    return [\"_inputChanged(email, _password)\"];\n  }\n\n  _inputChanged() {\n    this._error = \"\";\n    this.$.email.invalid = false;\n    this.$.password.invalid = false;\n  }\n\n  _keyDown(ev) {\n    // validate on enter\n    if (ev.keyCode === 13) {\n      this._handleRegister();\n      ev.preventDefault();\n    }\n  }\n\n  _handleRegister() {\n    let invalid = false;\n\n    if (!this.email || !this.email.includes(\"@\")) {\n      this.$.email.invalid = true;\n      this.$.email.focus();\n      invalid = true;\n    }\n\n    if (this._password.length < 8) {\n      this.$.password.invalid = true;\n\n      if (!invalid) {\n        invalid = true;\n        this.$.password.focus();\n      }\n    }\n\n    if (invalid) return;\n\n    this._requestInProgress = true;\n\n    this.hass\n      .callApi(\"post\", \"cloud/register\", {\n        email: this.email,\n        password: this._password,\n      })\n      .then(\n        () => this._verificationEmailSent(),\n        (err) => {\n          // Do this before setProperties because changing it clears errors.\n          this._password = \"\";\n\n          this.setProperties({\n            _requestInProgress: false,\n            _error:\n              err && err.body && err.body.message\n                ? err.body.message\n                : \"Unknown error\",\n          });\n        }\n      );\n  }\n\n  _handleResendVerifyEmail() {\n    if (!this.email) {\n      this.$.email.invalid = true;\n      return;\n    }\n\n    this.hass\n      .callApi(\"post\", \"cloud/resend_confirm\", {\n        email: this.email,\n      })\n      .then(\n        () => this._verificationEmailSent(),\n        (err) =>\n          this.setProperties({\n            _error:\n              err && err.body && err.body.message\n                ? err.body.message\n                : \"Unknown error\",\n          })\n      );\n  }\n\n  _verificationEmailSent() {\n    this.setProperties({\n      _requestInProgress: false,\n      _password: \"\",\n    });\n    this.fire(\"cloud-done\", {\n      flashMessage: this.hass.localize(\n        \"ui.panel.config.cloud.register.account_created\"\n      ),\n    });\n  }\n}\n\ncustomElements.define(\"cloud-register\", CloudRegister);\n"],"sourceRoot":""}