(self.webpackJsonp=self.webpackJsonp||[]).push([[74],{192:function(t,r,e){"use strict";var n=e(202);e.d(r,"a",function(){return o});const o=Object(n.a)({types:{"entity-id":function(t){return"string"!=typeof t?"entity id should be a string":!!t.includes(".")||"entity id should be in the format 'domain.entity'"},icon:function(t){return"string"!=typeof t?"icon should be a string":!!t.includes(":")||"icon should be in the format 'mdi:icon'"}}})},202:function(t,r,e){"use strict";e.d(r,"a",function(){return k});class n extends TypeError{static format(t){const{type:r,path:e,value:n}=t;return`Expected a value of type \`${r}\`${e.length?` for \`${e.join(".")}\``:""} but received \`${JSON.stringify(n)}\`.`}constructor(t){super(n.format(t));const{data:r,path:e,value:o,reason:a,type:i,errors:s=[]}=t;this.data=r,this.path=e,this.value=o,this.reason=a,this.type=i,this.errors=s,s.length||s.push(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack}}var o=Object.prototype.toString,a=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var r=typeof t;if("boolean"===r)return"boolean";if("string"===r)return"string";if("number"===r)return"number";if("symbol"===r)return"symbol";if("function"===r)return"GeneratorFunction"===i(t)?"generatorfunction":"function";if(function(t){return Array.isArray?Array.isArray(t):t instanceof Array}(t))return"array";if(function(t){if(t.constructor&&"function"==typeof t.constructor.isBuffer)return t.constructor.isBuffer(t);return!1}(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return!0}catch(r){if(-1!==r.message.indexOf("callee"))return!0}return!1}(t))return"arguments";if(function(t){return t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate}(t))return"date";if(function(t){return t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit}(t))return"error";if(function(t){return t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global}(t))return"regexp";switch(i(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(t){return"function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next}(t))return"generator";switch(r=o.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")};function i(t){return t.constructor?t.constructor.name:null}const s="@@__STRUCT__@@",c="@@__KIND__@@";function u(t){return!(!t||!t[s])}function l(t,r){return"function"==typeof t?t(r):t}var d=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t};class h{constructor(t,r,e){this.name=t,this.type=r,this.validate=e}}function f(t,r,e){if(u(t))return t[c];if(t instanceof h)return t;switch(a(t)){case"array":return t.length>1?w(t,r,e):y(t,r,e);case"function":return v(t,r,e);case"object":return m(t,r,e);case"string":{let n,o=!0;if(t.endsWith("?")&&(o=!1,t=t.slice(0,-1)),t.includes("|")){n=_(t.split(/\s*\|\s*/g),r,e)}else if(t.includes("&")){n=j(t.split(/\s*&\s*/g),r,e)}else n=b(t,r,e);return o||(n=g(n,void 0,e)),n}}throw new Error(`Invalid schema: ${t}`)}function p(t,r,e){if("array"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=t.map(t=>{try{return JSON.stringify(t)}catch(r){return String(t)}}).join(" | ");return new h("enum",n,(e=l(r))=>t.includes(e)?[void 0,e]:[{data:e,path:[],value:e,type:n}])}function v(t,r,e){if("function"!==a(t))throw new Error(`Invalid schema: ${t}`);return new h("function","<function>",(e=l(r),n)=>{const o=t(e,n);let i,s={path:[],reason:null};switch(a(o)){case"boolean":i=o;break;case"string":i=!1,s.reason=o;break;case"object":i=!1,s=d({},s,o);break;default:throw new Error(`Invalid result: ${o}`)}return i?[void 0,e]:[d({type:"<function>",value:e,data:e},s)]})}function y(t,r,e){if("array"!==a(t)||1!==t.length)throw new Error(`Invalid schema: ${t}`);const n=b("array",void 0,e),o=f(t[0],void 0,e),i=`[${o.type}]`;return new h("list",i,(t=l(r))=>{const[e,a]=n.validate(t);if(e)return e.type=i,[e];t=a;const s=[],c=[];for(let r=0;r<t.length;r++){const e=t[r],[n,a]=o.validate(e);n?(n.errors||[n]).forEach(e=>{e.path=[r].concat(e.path),e.data=t,s.push(e)}):c[r]=a}if(s.length){const t=s[0];return t.errors=s,[t]}return[void 0,c]})}function m(t,r,e){if("object"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=b("object",void 0,e),o=[],i={};for(const a in t){o.push(a);const r=f(t[a],void 0,e);i[a]=r}const s=`{${o.join()}}`;return new h("object",s,(t=l(r))=>{const[e]=n.validate(t);if(e)return e.type=s,[e];const o=[],a={},c=Object.keys(t),u=Object.keys(i);if(new Set(c.concat(u)).forEach(e=>{let n=t[e];const s=i[e];if(void 0===n&&(n=l(r&&r[e],t)),!s){const r={data:t,path:[e],value:n};return void o.push(r)}const[c,u]=s.validate(n,t);c?(c.errors||[c]).forEach(r=>{r.path=[e].concat(r.path),r.data=t,o.push(r)}):(e in t||void 0!==u)&&(a[e]=u)}),o.length){const t=o[0];return t.errors=o,[t]}return[void 0,a]})}function g(t,r,e){return _([t,"undefined"],r,e)}function b(t,r,e){if("string"!==a(t))throw new Error(`Invalid schema: ${t}`);const{types:n}=e,o=n[t];if("function"!==a(o))throw new Error(`Invalid type: ${t}`);const i=v(o,r),s=t;return new h("scalar",s,t=>{const[r,e]=i.validate(t);return r?(r.type=s,[r]):[void 0,e]})}function w(t,r,e){if("array"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=t.map(t=>f(t,void 0,e)),o=b("array",void 0,e),i=`[${n.map(t=>t.type).join()}]`;return new h("tuple",i,(t=l(r))=>{const[e]=o.validate(t);if(e)return e.type=i,[e];const a=[],s=[],c=Math.max(t.length,n.length);for(let r=0;r<c;r++){const e=n[r],o=t[r];if(!e){const e={data:t,path:[r],value:o};s.push(e);continue}const[i,c]=e.validate(o);i?(i.errors||[i]).forEach(e=>{e.path=[r].concat(e.path),e.data=t,s.push(e)}):a[r]=c}if(s.length){const t=s[0];return t.errors=s,[t]}return[void 0,a]})}function _(t,r,e){if("array"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=t.map(t=>f(t,void 0,e)),o=n.map(t=>t.type).join(" | ");return new h("union",o,(t=l(r))=>{const e=[];for(const r of n){const[n,o]=r.validate(t);if(!n)return[void 0,o];e.push(n)}return e[0].type=o,e})}function j(t,r,e){if("array"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=t.map(t=>f(t,void 0,e)),o=n.map(t=>t.type).join(" & ");return new h("intersection",o,(t=l(r))=>{let e=t;for(const r of n){const[t,n]=r.validate(e);if(t)return t.type=o,[t];e=n}return[void 0,e]})}const E={any:f,dict:function(t,r,e){if("array"!==a(t)||2!==t.length)throw new Error(`Invalid schema: ${t}`);const n=b("object",void 0,e),o=f(t[0],void 0,e),i=f(t[1],void 0,e),s=`dict<${o.type},${i.type}>`;return new h("dict",s,t=>{const e=l(r);t=e?d({},e,t):t;const[a]=n.validate(t);if(a)return a.type=s,[a];const c={},u=[];for(let r in t){const e=t[r],[n,a]=o.validate(r);if(n){(n.errors||[n]).forEach(e=>{e.path=[r].concat(e.path),e.data=t,u.push(e)});continue}r=a;const[s,l]=i.validate(e);s?(s.errors||[s]).forEach(e=>{e.path=[r].concat(e.path),e.data=t,u.push(e)}):c[r]=l}if(u.length){const t=u[0];return t.errors=u,[t]}return[void 0,c]})},enum:p,enums:function(t,r,e){return y([p(t,void 0)],r,e)},function:v,instance:function(t,r,e){const n=`instance<${t.name}>`;return new h("instance",n,(e=l(r))=>e instanceof t?[void 0,e]:[{data:e,path:[],value:e,type:n}])},interface:function(t,r,e){if("object"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=[],o={};for(const a in t){n.push(a);const r=f(t[a],void 0,e);o[a]=r}const i=`{${n.join()}}`;return new h("interface",i,t=>{const e=l(r);t=e?d({},e,t):t;const n=[],a=t;for(const i in o){let e=t[i];const s=o[i];void 0===e&&(e=l(r&&r[i],t));const[c,u]=s.validate(e,t);c?(c.errors||[c]).forEach(r=>{r.path=[i].concat(r.path),r.data=t,n.push(r)}):(i in t||void 0!==u)&&(a[i]=u)}if(n.length){const t=n[0];return t.errors=n,[t]}return[void 0,a]})},lazy:function(t,r,e){if("function"!==a(t))throw new Error(`Invalid schema: ${t}`);let n,o;return n=new h("lazy","lazy...",r=>(o=t(),n.name=o.kind,n.type=o.type,n.validate=o.validate,n.validate(r)))},list:y,literal:function(t,r,e){const n=`literal: ${JSON.stringify(t)}`;return new h("literal",n,(e=l(r))=>e===t?[void 0,e]:[{data:e,path:[],value:e,type:n}])},object:m,optional:g,partial:function(t,r,e){if("object"!==a(t))throw new Error(`Invalid schema: ${t}`);const n=b("object",void 0,e),o=[],i={};for(const a in t){o.push(a);const r=f(t[a],void 0,e);i[a]=r}const s=`{${o.join()},...}`;return new h("partial",s,(t=l(r))=>{const[e]=n.validate(t);if(e)return e.type=s,[e];const o=[],a={};for(const n in i){let e=t[n];const s=i[n];void 0===e&&(e=l(r&&r[n],t));const[c,u]=s.validate(e,t);c?(c.errors||[c]).forEach(r=>{r.path=[n].concat(r.path),r.data=t,o.push(r)}):(n in t||void 0!==u)&&(a[n]=u)}if(o.length){const t=o[0];return t.errors=o,[t]}return[void 0,a]})},scalar:b,tuple:w,union:_,intersection:j,dynamic:function(t,r,e){if("function"!==a(t))throw new Error(`Invalid schema: ${t}`);return new h("dynamic","dynamic...",(e=l(r),n)=>{const o=t(e,n);if("function"!==a(o))throw new Error(`Invalid schema: ${o}`);const[i,s]=o.validate(e);return i?[i]:[void 0,s]})}},$={any:t=>void 0!==t};function k(t={}){const r=d({},$,t.types||{});function e(t,e,o={}){u(t)&&(t=t.schema);const a=E.any(t,e,d({},o,{types:r}));function i(t){if(this instanceof i)throw new Error("Invalid `new` keyword!");return i.assert(t)}return Object.defineProperty(i,s,{value:!0}),Object.defineProperty(i,c,{value:a}),i.kind=a.name,i.type=a.type,i.schema=t,i.defaults=e,i.options=o,i.assert=(t=>{const[r,e]=a.validate(t);if(r)throw new n(r);return e}),i.test=(t=>{const[r]=a.validate(t);return!r}),i.validate=(t=>{const[r,e]=a.validate(t);return r?[new n(r)]:[void 0,e]}),i}return Object.keys(E).forEach(t=>{const n=E[t];e[t]=((t,o,a)=>{return e(n(t,o,d({},a,{types:r})),o,a)})}),e}["arguments","array","boolean","buffer","error","float32array","float64array","function","generatorfunction","int16array","int32array","int8array","map","null","number","object","promise","regexp","set","string","symbol","uint16array","uint32array","uint8array","uint8clampedarray","undefined","weakmap","weakset"].forEach(t=>{$[t]=(r=>a(r)===t)}),$.date=(t=>"date"===a(t)&&!isNaN(t));k()},240:function(t,r,e){"use strict";var n=e(3);let o;var a=e(18),i=e(0);let s=class extends i.b{constructor(){super(...arguments),this.autofocus=!1,this.rtl=!1,this.error=!1,this._value=""}set value(t){this._value=t}get value(){return this.codemirror?this.codemirror.getValue():this._value}get hasComments(){return!!this.shadowRoot.querySelector("span.cm-comment")}connectedCallback(){super.connectedCallback(),this.codemirror&&(this.codemirror.refresh(),!1!==this.autofocus&&this.codemirror.focus())}update(t){super.update(t),this.codemirror&&(t.has("mode")&&this.codemirror.setOption("mode",this.mode),t.has("autofocus")&&this.codemirror.setOption("autofocus",!1!==this.autofocus),t.has("_value")&&this._value!==this.value&&this.codemirror.setValue(this._value),t.has("rtl")&&(this.codemirror.setOption("gutters",this._calcGutters()),this._setScrollBarDirection()),t.has("error")&&this.classList.toggle("error-state",this.error))}firstUpdated(t){super.firstUpdated(t),this._load()}async _load(){const t=await(async()=>(o||(o=Promise.all([e.e(114),e.e(23)]).then(e.bind(null,717))),o))(),r=t.codeMirror,n=this.attachShadow({mode:"open"});n.innerHTML=`\n    <style>\n      ${t.codeMirrorCss}\n      .CodeMirror {\n        height: var(--code-mirror-height, auto);\n        direction: var(--code-mirror-direction, ltr);\n      }\n      .CodeMirror-scroll {\n        max-height: var(--code-mirror-max-height, --code-mirror-height);\n      }\n      .CodeMirror-gutters {\n        border-right: 1px solid var(--paper-input-container-color, var(--secondary-text-color));\n        background-color: var(--paper-dialog-background-color, var(--primary-background-color));\n        transition: 0.2s ease border-right;\n      }\n      :host(.error-state) .CodeMirror-gutters {\n        border-color: var(--error-state-color, red);\n      }\n      .CodeMirror-focused .CodeMirror-gutters {\n        border-right: 2px solid var(--paper-input-container-focus-color, var(--primary-color));\n      }\n      .CodeMirror-linenumber {\n        color: var(--paper-dialog-color, var(--primary-text-color));\n      }\n      .rtl .CodeMirror-vscrollbar {\n        right: auto;\n        left: 0px;\n      }\n      .rtl-gutter {\n        width: 20px;\n      }\n    </style>`,this.codemirror=r(n,{value:this._value,lineNumbers:!0,tabSize:2,mode:this.mode,autofocus:!1!==this.autofocus,viewportMargin:1/0,extraKeys:{Tab:"indentMore","Shift-Tab":"indentLess"},gutters:this._calcGutters()}),this._setScrollBarDirection(),this.codemirror.on("changes",()=>this._onChange())}_onChange(){const t=this.value;t!==this._value&&(this._value=t,Object(a.a)(this,"value-changed",{value:this._value}))}_calcGutters(){return this.rtl?["rtl-gutter","CodeMirror-linenumbers"]:[]}_setScrollBarDirection(){this.codemirror&&this.codemirror.getWrapperElement().classList.toggle("rtl",this.rtl)}};Object(n.c)([Object(i.g)()],s.prototype,"mode",void 0),Object(n.c)([Object(i.g)()],s.prototype,"autofocus",void 0),Object(n.c)([Object(i.g)()],s.prototype,"rtl",void 0),Object(n.c)([Object(i.g)()],s.prototype,"error",void 0),Object(n.c)([Object(i.g)()],s.prototype,"_value",void 0),s=Object(n.c)([Object(i.d)("ha-code-editor")],s)},692:function(t,r,e){"use strict";e.r(r);var n=e(0),o=e(73),a=e(288),i=e.n(a),s=(e(205),e(220),e(150),e(85),e(108),e(188),e(192)),c=(e(179),e(56)),u=(e(240),e(96));const l=s.a.interface({title:"string?",views:["object"],resources:s.a.optional(["object"])});customElements.define("hui-editor",class extends n.a{constructor(){super(...arguments),this._generation=1}static get properties(){return{hass:{},lovelace:{},closeEditor:{},_saving:{},_changed:{}}}render(){return n.f`
      <app-header-layout>
        <app-header>
          <app-toolbar>
            <paper-icon-button
              icon="hass:close"
              @click="${this._closeEditor}"
            ></paper-icon-button>
            <div main-title>
              ${this.hass.localize("ui.panel.lovelace.editor.raw_editor.header")}
            </div>
            <div
              class="save-button
              ${Object(o.a)({saved:!1===this._saving||!0===this._changed})}"
            >
              ${this._changed?this.hass.localize("ui.panel.lovelace.editor.raw_editor.unsaved_changes"):this.hass.localize("ui.panel.lovelace.editor.raw_editor.saved")}
            </div>
            <mwc-button raised @click="${this._handleSave}"
              >${this.hass.localize("ui.panel.lovelace.editor.raw_editor.save")}</mwc-button
            >
          </app-toolbar>
        </app-header>
        <div class="content">
          <ha-code-editor
            mode="yaml"
            autofocus
            .rtl=${Object(u.a)(this.hass)}
            .hass="${this.hass}"
            @value-changed="${this._yamlChanged}"
            @editor-save="${this._handleSave}"
          >
          </ha-code-editor>
        </div>
      </app-header-layout>
    `}firstUpdated(){this.yamlEditor.value=i.a.safeDump(this.lovelace.config)}static get styles(){return[c.a,n.c`
        :host {
          --code-mirror-height: 100%;
        }

        app-header-layout {
          height: 100vh;
        }

        app-toolbar {
          background-color: var(--dark-background-color, #455a64);
          color: var(--dark-text-color);
        }

        .comments {
          font-size: 16px;
        }

        .content {
          height: calc(100vh - 68px);
        }

        hui-code-editor {
          height: 100%;
        }

        .save-button {
          opacity: 0;
          font-size: 14px;
          padding: 0px 10px;
        }

        .saved {
          opacity: 1;
        }
      `]}_yamlChanged(){this._changed=!this.yamlEditor.codemirror.getDoc().isClean(this._generation),this._changed&&!window.onbeforeunload?window.onbeforeunload=(()=>!0):!this._changed&&window.onbeforeunload&&(window.onbeforeunload=null)}_closeEditor(){this._changed&&!confirm("You have unsaved changes, are you sure you want to exit?")||(window.onbeforeunload=null,this.closeEditor&&this.closeEditor())}async _handleSave(){if(this._saving=!0,this.yamlEditor.hasComments&&!confirm("Your config contains comment(s), these will not be saved. Do you want to continue?"))return;let t;try{t=i.a.safeLoad(this.yamlEditor.value)}catch(r){return alert(`Unable to parse YAML: ${r}`),void(this._saving=!1)}try{t=l(t)}catch(r){return void alert(`Your config is not valid: ${r}`)}try{await this.lovelace.saveConfig(t)}catch(r){alert(`Unable to save YAML: ${r}`)}this._generation=this.yamlEditor.codemirror.getDoc().changeGeneration(!0),window.onbeforeunload=null,this._saving=!1,this._changed=!1}get yamlEditor(){return this.shadowRoot.querySelector("ha-code-editor")}})}}]);
//# sourceMappingURL=chunk.98175aeb9a46f4a3a3aa.js.map