(window.webpackJsonpfrontend=window.webpackJsonpfrontend||[]).push([[0],{10:function(e,a,t){e.exports=t(23)},15:function(e,a,t){},22:function(e,a,t){},23:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),s=t(7),r=t.n(s),c=(t(15),t(8)),i=t(1),o=t(2),m=t(4),u=t(3),d=t(5),p=t(9),_=t.n(p);t(22);function h(e){return Array.isArray(e)?e.join(" "):Object.keys(e).filter(function(a){return!!e[a]}).join(" ")}var f=function(e){function a(){return Object(i.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement("header",{className:"header"},l.a.createElement("div",{className:"header__name"},"Captum Insights"),l.a.createElement("nav",{className:"header__nav"},l.a.createElement("ul",null,l.a.createElement("li",{className:"header__nav__item header__nav__item--active"},"Instance Attribution"))))}}]),a}(l.a.Component);function g(e){return l.a.createElement("div",{className:"tooltip"},l.a.createElement("div",{className:"tooltip__label"},e.label))}var v=function(e){function a(e){var t;Object(i.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).handleClassDelete=function(e){var a=t.state.classes.slice(0),n=a.splice(e,1),l=[].concat(t.state.suggested_classes,n);t.setState({classes:a,suggested_classes:l})},t.handleClassAdd=function(e){var a=[].concat(t.state.classes,e),n=t.state.suggested_classes.filter(function(a){return a.id!==e.id});t.setState({classes:a,suggested_classes:n})},t.handleInputChange=function(e){var a=e.target,n="checkbox"===a.type?a.checked:a.value,l=a.name;t.setState(Object(c.a)({},l,n))},t.handleSubmit=function(e){var a={prediction:t.state.prediction,approximation_steps:t.state.approximation_steps,classes:t.state.classes.map(function(e){return e.name})};t.props.fetchData(a),e.preventDefault()};var n=e.config.map(function(e,a){return{id:a,name:e}});return t.state={prediction:"all",approximation_steps:20,classes:[],suggested_classes:n},t}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(E,{prediction:this.state.prediction,classes:this.state.classes,suggestedClasses:this.state.suggested_classes,approximationSteps:this.state.approximation_steps,handleClassAdd:this.handleClassAdd,handleClassDelete:this.handleClassDelete,handleInputChange:this.handleInputChange,handleSubmit:this.handleSubmit})}}]),a}(l.a.Component),b=function(e){function a(){return Object(i.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement(_.a,{tags:this.props.classes,autofocus:!1,suggestions:this.props.suggestedClasses,handleDelete:this.props.handleClassDelete,handleAddition:this.props.handleClassAdd,minQueryLength:0,placeholder:"add new class..."})}}]),a}(l.a.Component),E=function(e){function a(){return Object(i.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement("form",{onSubmit:this.props.handleSubmit},l.a.createElement("div",{className:"filter-panel"},l.a.createElement("div",{className:"filter-panel__column"},l.a.createElement("div",{className:"filter-panel__column__title"},"Filter by Classes"),l.a.createElement("div",{className:"filter-panel__column__body"},l.a.createElement(b,{handleClassDelete:this.props.handleClassDelete,handleClassAdd:this.props.handleClassAdd,suggestedClasses:this.props.suggestedClasses,classes:this.props.classes}))),l.a.createElement("div",{className:"filter-panel__column"},l.a.createElement("div",{className:"filter-panel__column__title"},"Filter by Instances"),l.a.createElement("div",{className:"filter-panel__column__body"},"Prediction:"," ",l.a.createElement("select",{className:"select",name:"prediction",onChange:this.props.handleInputChange,value:this.props.prediction},l.a.createElement("option",{value:"all"},"All"),l.a.createElement("option",{value:"correct"},"Correct"),l.a.createElement("option",{value:"incorrect"},"Incorrect")))),l.a.createElement("div",{className:"filter-panel__column"},l.a.createElement("div",{className:"filter-panel__column__title"},"Integrated Gradients"),l.a.createElement("div",{className:"filter-panel__column__body"},"Approximation steps:"," ",l.a.createElement("input",{className:"input input--narrow",name:"approximation_steps",type:"number",value:this.props.approximationSteps,onChange:this.props.handleInputChange}))),l.a.createElement("div",{className:"filter-panel__column filter-panel__column--end"},l.a.createElement("button",{className:"btn btn--outline btn--large"},"Fetch"))))}}]),a}(l.a.Component);function N(e){return l.a.createElement("div",{className:"spinner"})}function C(e){var a=null;a=e>0?[220,100,80]:[10,100,67];var t=[0,40,arguments.length>1&&void 0!==arguments[1]&&arguments[1]?100:90],n=Math.abs(.01*e);if(n<.02)return t;var l=[a[0],(a[1]-t[1])*n+t[1],(a[2]-t[2])*n+t[2]];return"hsl(".concat(l[0],", ").concat(l[1],"%, ").concat(l[2],"%)")}function y(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"panel__column__title"},e.data.name," (Image)"),l.a.createElement("div",{className:"panel__column__body"},l.a.createElement("div",{className:"gallery"},l.a.createElement("div",{className:"gallery__item"},l.a.createElement("div",{className:"gallery__item__image"},l.a.createElement("img",{src:"data:image/png;base64,"+e.data.base})),l.a.createElement("div",{className:"gallery__item__description"},"Original")),l.a.createElement("div",{className:"gallery__item"},l.a.createElement("div",{className:"gallery__item__image"},l.a.createElement("img",{src:"data:image/png;base64,"+e.data.modified})),l.a.createElement("div",{className:"gallery__item__description"},"Attribution Magnitude")))))}function j(e){var a=e.data.base.map(function(a,t){return l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{backgroundColor:C(e.data.modified[t],!1)},className:"text-feature-word"},a,l.a.createElement(g,{label:e.data.modified[t].toFixed(3)}))," ")});return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"panel__column__title"},e.data.name," (Text)"),l.a.createElement("div",{className:"panel__column__body"},a))}function O(e){var a=e.data.base.map(function(a,t){var n=e.data.modified[t].toFixed(3),s="general-feature__bar__"+(n>0?"positive":"negative"),r=Math.abs(n)+"%";return l.a.createElement("div",{className:"general-feature"},l.a.createElement("span",{className:"general-feature__label-container"},l.a.createElement("span",{className:"general-feature__label"},a),l.a.createElement("span",{className:"general-feature__percent"},n)),l.a.createElement("div",{className:"general-feature__bar-container"},l.a.createElement("span",{className:h(["general-feature__bar",s]),style:{width:r}})))});return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"panel__column__title"},e.data.name," (General)"),l.a.createElement("div",{className:"panel__column__body"},a))}function k(e){var a=e.data;switch(a.type){case"image":return l.a.createElement(y,{data:a});case"text":return l.a.createElement(j,{data:a});case"general":return l.a.createElement(O,{data:a});default:throw new Error("Unsupported feature visualization type: "+a.type)}}var x=function(e){function a(){return Object(i.a)(this,a),Object(m.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return this.props.feature_outputs.map(function(e){var a=100*e.contribution,t=a>10?a:a+10;return l.a.createElement("div",{className:"bar-chart__group"},l.a.createElement("div",{className:"bar-chart__group__bar",style:{height:t+"px",backgroundColor:C(a)}}),l.a.createElement("div",{className:"bar-chart__group__title"},e.name))})}}]),a}(l.a.Component),S=function(e){function a(){var e,t;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),s=0;s<n;s++)l[s]=arguments[s];return(t=Object(m.a)(this,(e=Object(u.a)(a)).call.apply(e,[this].concat(l)))).onClick=function(e){e.preventDefault(),t.props.onTargetClick(t.props.labelIndex,t.props.instance)},t}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement("button",{onClick:this.onClick,className:h({btn:!0,"btn--solid":this.props.active,"btn--outline":!this.props.active})},this.props.children)}}]),a}(l.a.Component),w=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e))).onTargetClick=function(e,a){t.setState({loading:!0}),t.props.onTargetClick(e,a,function(){return t.setState({loading:!1})})},t.state={loading:!1},t}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){var e=this,a=this.props.data,t=a.feature_outputs.map(function(e){return l.a.createElement(k,{data:e})});return l.a.createElement(l.a.Fragment,null,this.state.loading&&l.a.createElement("div",{className:"loading"},l.a.createElement(N,null)),l.a.createElement("div",{className:h({panel:!0,"panel--long":!0,"panel--loading":this.state.loading})},l.a.createElement("div",{className:"panel__column"},l.a.createElement("div",{className:"panel__column__title"},"Predicted"),l.a.createElement("div",{className:"panel__column__body"},a.predicted.map(function(t){return l.a.createElement("div",{className:"row row--padding"},l.a.createElement(S,{onTargetClick:e.onTargetClick,labelIndex:t.index,instance:e.props.instance,active:t.index===a.active_index},t.label," (",t.score.toFixed(3),")"))}))),l.a.createElement("div",{className:"panel__column"},l.a.createElement("div",{className:"panel__column__title"},"Label"),l.a.createElement("div",{className:"panel__column__body"},l.a.createElement("div",{className:"row row--padding"},l.a.createElement(S,{onTargetClick:this.onTargetClick,labelIndex:a.actual.index,instance:this.props.instance,active:a.actual.index===a.active_index},a.actual.label)))),l.a.createElement("div",{className:"panel__column"},l.a.createElement("div",{className:"panel__column__title"},"Contribution"),l.a.createElement("div",{className:"panel__column__body"},l.a.createElement("div",{className:"bar-chart"},l.a.createElement(x,{feature_outputs:a.feature_outputs})))),l.a.createElement("div",{className:"panel__column panel__column--stretch"},t)))}}]),a}(l.a.Component);function I(e){return e.loading?l.a.createElement("div",{className:"viz"},l.a.createElement("div",{className:"panel panel--center"},l.a.createElement(N,null))):e.data&&0!==e.data.length?l.a.createElement("div",{className:"viz"},e.data.map(function(a,t){return l.a.createElement(w,{data:a,instance:t,key:t,onTargetClick:e.onTargetClick})})):l.a.createElement("div",{className:"viz"},l.a.createElement("div",{className:"panel"},l.a.createElement("div",{className:"panel__column"},"Please press ",l.a.createElement("strong",{className:"text-feature-word"},"Fetch")," to start loading data.")))}var T=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(m.a)(this,Object(u.a)(a).call(this,e)))._fetchInit=function(){fetch("/init").then(function(e){return e.json()}).then(function(e){return t.setState({config:e})})},t.fetchData=function(e){t.setState({loading:!0}),fetch("/fetch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(e){return t.setState({data:e,loading:!1})})},t.onTargetClick=function(e,a,n){fetch("/attribute",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({labelIndex:e,instance:a})}).then(function(e){return e.json()}).then(function(e){var l=Object.assign([],t.state.data);l[a]=e,t.setState({data:l}),n()})},t.state={data:[],config:[],loading:!1},t._fetchInit(),t}return Object(d.a)(a,e),Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:"app"},l.a.createElement(f,null),l.a.createElement(v,{fetchData:this.fetchData,config:this.state.config,key:this.state.config}),l.a.createElement(I,{data:this.state.data,loading:this.state.loading,onTargetClick:this.onTargetClick}))}}]),a}(l.a.Component);r.a.render(l.a.createElement(T,null),document.getElementById("root"))}},[[10,1,2]]]);
//# sourceMappingURL=main.e8d30be4.chunk.js.map