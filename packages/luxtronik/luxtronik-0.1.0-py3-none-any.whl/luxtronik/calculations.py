from luxtronik.datatypes import *


class Calculations:
    calculations = {
        1: ("Unknown_1", Unknown),
        2: ("Unknown_2", Unknown),
        3: ("Unknown_3", Unknown),
        4: ("Unknown_4", Unknown),
        5: ("Unknown_5", Unknown),
        6: ("Unknown_6", Unknown),
        7: ("Unknown_7", Unknown),
        8: ("Unknown_8", Unknown),
        9: ("Unknown_9", Unknown),
        10: ("ID_WEB_Temperatur_TVL", Celsius),
        11: ("ID_WEB_Temperatur_TRL", Celsius),
        12: ("ID_WEB_Sollwert_TRL_HZ", Celsius),
        13: ("ID_WEB_Temperatur_TRL_ext", Celsius),
        14: ("ID_WEB_Temperatur_THG", Celsius),
        15: ("ID_WEB_Temperatur_TA", Celsius),
        16: ("ID_WEB_Mitteltemperatur", Celsius),
        17: ("ID_WEB_Temperatur_TBW", Celsius),
        18: ("ID_WEB_Einst_BWS_akt", Celsius),
        19: ("ID_WEB_Temperatur_TWE", Celsius),
        20: ("ID_WEB_Temperatur_TWA", Celsius),
        21: ("ID_WEB_Temperatur_TFB1", Celsius),
        22: ("ID_WEB_Sollwert_TVL_MK1", Celsius),
        23: ("ID_WEB_Temperatur_RFV", Celsius),
        24: ("ID_WEB_Temperatur_TFB2", Celsius),
        25: ("ID_WEB_Sollwert_TVL_MK2", Celsius),
        26: ("ID_WEB_Temperatur_TSK", Celsius),
        27: ("ID_WEB_Temperatur_TSS", Celsius),
        28: ("ID_WEB_Temperatur_TEE", Celsius),
        29: ("ID_WEB_ASDin", Bool),
        30: ("ID_WEB_BWTin", Bool),
        31: ("ID_WEB_EVUin", Bool),
        32: ("ID_WEB_HDin", Bool),
        33: ("ID_WEB_MOTin", Bool),
        34: ("ID_WEB_NDin", Bool),
        35: ("ID_WEB_PEXin", Bool),
        36: ("ID_WEB_SWTin", Bool),
        37: ("ID_WEB_AVout", Bool),
        38: ("ID_WEB_BUPout", Bool),
        39: ("ID_WEB_HUPout", Bool),
        40: ("ID_WEB_MA1out", Bool),
        41: ("ID_WEB_MZ1out", Bool),
        42: ("ID_WEB_VENout", Bool),
        43: ("ID_WEB_VBOout", Bool),
        44: ("ID_WEB_VD1out", Bool),
        45: ("ID_WEB_VD2out", Bool),
        46: ("ID_WEB_ZIPout", Bool),
        47: ("ID_WEB_ZUPout", Bool),
        48: ("ID_WEB_ZW1out", Bool),
        49: ("ID_WEB_ZW2SSTout", Bool),
        50: ("ID_WEB_ZW3SSTout", Bool),
        51: ("ID_WEB_FP2out", Bool),
        52: ("ID_WEB_SLPout", Bool),
        53: ("ID_WEB_SUPout", Bool),
        54: ("ID_WEB_MZ2out", Bool),
        55: ("ID_WEB_MA2out", Bool),
        56: ("ID_WEB_Zaehler_BetrZeitVD1", Seconds),
        57: ("ID_WEB_Zaehler_BetrZeitImpVD1", Pulses),
        58: ("ID_WEB_Zaehler_BetrZeitVD2", Seconds),
        59: ("ID_WEB_Zaehler_BetrZeitImpVD2", Pulses),
        60: ("ID_WEB_Zaehler_BetrZeitZWE1", Seconds),
        61: ("ID_WEB_Zaehler_BetrZeitZWE2", Seconds),
        62: ("ID_WEB_Zaehler_BetrZeitZWE3", Seconds),
        63: ("ID_WEB_Zaehler_BetrZeitWP", Seconds),
        64: ("ID_WEB_Zaehler_BetrZeitHz", Seconds),
        65: ("ID_WEB_Zaehler_BetrZeitBW", Seconds),
        66: ("ID_WEB_Zaehler_BetrZeitKue", Seconds),
        67: ("ID_WEB_Time_WPein_akt", Seconds),
        68: ("ID_WEB_Time_ZWE1_akt", Seconds),
        69: ("ID_WEB_Time_ZWE2_akt", Seconds),
        70: ("ID_WEB_Timer_EinschVerz", Seconds),
        71: ("ID_WEB_Time_SSPAUS_akt", Seconds),
        72: ("ID_WEB_Time_SSPEIN_akt", Seconds),
        73: ("ID_WEB_Time_VDStd_akt", Seconds),
        74: ("ID_WEB_Time_HRM_akt", Seconds),
        75: ("ID_WEB_Time_HRW_akt", Seconds),
        76: ("ID_WEB_Time_LGS_akt", Seconds),
        77: ("ID_WEB_Time_SBW_akt", Seconds),
        78: ("ID_WEB_Code_WP_akt", Code_WP),
        79: ("ID_WEB_BIV_Stufe_akt", BivalenceLevel),
        81: ("ID_WEB_SoftStand", Version),
        91: ("ID_WEB_AdresseIP_akt", IPAddress),
        92: ("ID_WEB_SubNetMask_akt", IPAddress),
        93: ("ID_WEB_Add_Broadcast", IPAddress),
        94: ("ID_WEB_Add_StdGateway", IPAddress),
        95: ("ID_WEB_ERROR_Time0", Timestamp),
        96: ("ID_WEB_ERROR_Time1", Timestamp),
        97: ("ID_WEB_ERROR_Time2", Timestamp),
        98: ("ID_WEB_ERROR_Time3", Timestamp),
        99: ("ID_WEB_ERROR_Time4", Timestamp),
        100: ("ID_WEB_ERROR_Nr0", Errorcode),
        101: ("ID_WEB_ERROR_Nr1", Errorcode),
        102: ("ID_WEB_ERROR_Nr2", Errorcode),
        103: ("ID_WEB_ERROR_Nr3", Errorcode),
        104: ("ID_WEB_ERROR_Nr4", Errorcode),
        105: ("ID_WEB_AnzahlFehlerInSpeicher", Count),
        106: ("ID_WEB_Switchoff_file_Nr0", SwitchoffFile),
        107: ("ID_WEB_Switchoff_file_Nr1", SwitchoffFile),
        108: ("ID_WEB_Switchoff_file_Nr2", SwitchoffFile),
        109: ("ID_WEB_Switchoff_file_Nr3", SwitchoffFile),
        110: ("ID_WEB_Switchoff_file_Nr4", SwitchoffFile),
        111: ("ID_WEB_Switchoff_file_Time0", Timestamp),
        112: ("ID_WEB_Switchoff_file_Time1", Timestamp),
        113: ("ID_WEB_Switchoff_file_Time2", Timestamp),
        114: ("ID_WEB_Switchoff_file_Time3", Timestamp),
        115: ("ID_WEB_Switchoff_file_Time4", Timestamp),
        116: ("ID_WEB_Comfort_exists", Bool),
        117: ("ID_WEB_HauptMenuStatus_Zeile1", MainMenuStatusLine1),
        118: ("ID_WEB_HauptMenuStatus_Zeile2", MainMenuStatusLine2),
        119: ("ID_WEB_HauptMenuStatus_Zeile3", MainMenuStatusLine3),
        120: ("ID_WEB_HauptMenuStatus_Zeit", Seconds),
        121: ("ID_WEB_HauptMenuAHP_Stufe", Level),
        122: ("ID_WEB_HauptMenuAHP_Temp", Celsius),
        123: ("ID_WEB_HauptMenuAHP_Zeit", Seconds),
        124: ("ID_WEB_SH_BWW", Bool),
        125: ("ID_WEB_SH_HZ", Icon),
        126: ("ID_WEB_SH_MK1", Icon),
        127: ("ID_WEB_SH_MK2", Icon),
        128: ("ID_WEB_Einst_Kurzrpgramm", Unknown),
        129: ("ID_WEB_StatusSlave_1", Unknown),
        130: ("ID_WEB_StatusSlave_2", Unknown),
        131: ("ID_WEB_StatusSlave_3", Unknown),
        132: ("ID_WEB_StatusSlave_4", Unknown),
        133: ("ID_WEB_StatusSlave_5", Unknown),
        134: ("ID_WEB_AktuelleTimeStamp", Timestamp),
        135: ("ID_WEB_SH_MK3", Icon),
        136: ("ID_WEB_Sollwert_TVL_MK3", Celsius),
        137: ("ID_WEB_Temperatur_TFB3", Celsius),
        138: ("ID_WEB_MZ3out", Bool),
        139: ("ID_WEB_MA3out", Bool),
        140: ("ID_WEB_FP3out", Bool),
        141: ("ID_WEB_Time_AbtIn", Seconds),
        142: ("ID_WEB_Temperatur_RFV2", Celsius),
        143: ("ID_WEB_Temperatur_RFV3", Celsius),
        144: ("ID_WEB_SH_SW", Icon),
        145: ("ID_WEB_Zaehler_BetrZeitSW", Unknown),
        146: ("ID_WEB_FreigabKuehl", Bool),
        147: ("ID_WEB_AnalogIn", Voltage),
        148: ("ID_WEB_SonderZeichen", Unknown),
        149: ("ID_WEB_SH_ZIP", Icon),
        150: ("ID_WEB_WebsrvProgrammWerteBeobarten", Icon),
        151: ("ID_WEB_WMZ_Heizung", Energy),
        152: ("ID_WEB_WMZ_Brauchwasser", Energy),
        153: ("ID_WEB_WMZ_Schwimmbad", Energy),
        154: ("ID_WEB_WMZ_Seit", Energy),
        155: ("ID_WEB_WMZ_Durchfluss", Flow),
        156: ("ID_WEB_AnalogOut1", Voltage),
        157: ("ID_WEB_AnalogOut2", Voltage),
        158: ("ID_WEB_Time_Heissgas", Seconds),
        159: ("ID_WEB_Temp_Lueftung_Zuluft", Celsius),
        160: ("ID_WEB_Temp_Lueftung_Abluft", Celsius),
        161: ("ID_WEB_Zaehler_BetrZeitSolar", Seconds),
        162: ("ID_WEB_AnalogOut3", Voltage),
        163: ("ID_WEB_AnalogOut4", Voltage),
        164: ("ID_WEB_Out_VZU", Voltage),
        165: ("ID_WEB_Out_VAB", Voltage),
        166: ("ID_WEB_Out_VSK", Bool),
        167: ("ID_WEB_Out_FRH", Bool),
        168: ("ID_WEB_AnalogIn2", Voltage),
        169: ("ID_WEB_AnalogIn3", Voltage),
        170: ("ID_WEB_SAXin", Bool),
        171: ("ID_WEB_SPLin", Bool),
        172: ("ID_WEB_Compact_exists", Bool),
        173: ("ID_WEB_Durchfluss_WQ", Bool),
        174: ("ID_WEB_LIN_exists", Bool),
        175: ("ID_WEB_LIN_ANSAUG_VERDAMPFER", Celsius),
        176: ("ID_WEB_LIN_ANSAUG_VERDICHTER", Celsius),
        177: ("ID_WEB_LIN_VDH", Celsius),
        178: ("ID_WEB_LIN_UH", Kelvin),
        179: ("ID_WEB_LIN_UH_Soll", Kelvin),
        180: ("ID_WEB_LIN_HD", Pressure),
        181: ("ID_WEB_LIN_ND", Pressure),
        182: ("ID_WEB_LIN_VDH_out", Bool),
        183: ("ID_WEB_HZIO_PWM", Percent),
        184: ("ID_WEB_HZIO_VEN", Speed),
        185: ("ID_WEB_HZIO_EVU2", Unknown),
        186: ("ID_WEB_HZIO_STB", Bool),
        187: ("ID_WEB_SEC_Qh_Soll", Energy),
        188: ("ID_WEB_SEC_Qh_Ist", Energy),
        189: ("ID_WEB_SEC_TVL_Soll", Celsius),
        190: ("ID_WEB_SEC_Software", Unknown),
        191: ("ID_WEB_SEC_BZ", SecOperationMode),
        192: ("ID_WEB_SEC_VWV", Unknown),
        193: ("ID_WEB_SEC_VD", Speed),
        194: ("ID_WEB_SEC_VerdEVI", Celsius),
        195: ("ID_WEB_SEC_AnsEVI", Celsius),
        196: ("ID_WEB_SEC_UEH_EVI", Kelvin),
        197: ("ID_WEB_SEC_UEH_EVI_S", Kelvin),
        198: ("ID_WEB_SEC_KondTemp", Celsius),
        199: ("ID_WEB_SEC_FlussigEx", Celsius),
        200: ("ID_WEB_SEC_UK_EEV", Celsius),
        201: ("ID_WEB_SEC_EVI_Druck", Pressure),
        202: ("ID_WEB_SEC_U_Inv", Voltage),
        203: ("ID_WEB_Temperatur_THG_2", Celsius),
        204: ("ID_WEB_Temperatur_TWE_2", Celsius),
        205: ("ID_WEB_LIN_ANSAUG_VERDAMPFER_2", Celsius),
        206: ("ID_WEB_LIN_ANSAUG_VERDICHTER_2", Celsius),
        207: ("ID_WEB_LIN_VDH_2", Celsius),
        208: ("ID_WEB_LIN_UH_2", Kelvin),
        209: ("ID_WEB_LIN_UH_Soll_2", Kelvin),
        210: ("ID_WEB_LIN_HD_2", Pressure),
        211: ("ID_WEB_LIN_ND_2", Pressure),
        212: ("ID_WEB_HDin_2", Bool),
        213: ("ID_WEB_AVout_2", Bool),
        214: ("ID_WEB_VBOout_2", Bool),
        215: ("ID_WEB_VD1out_2", Bool),
        216: ("ID_WEB_LIN_VDH_out_2", Bool),
        217: ("ID_WEB_Switchoff2_file_Nr0", SwitchoffFile),
        218: ("ID_WEB_Switchoff2_file_Nr1", SwitchoffFile),
        219: ("ID_WEB_Switchoff2_file_Nr2", SwitchoffFile),
        220: ("ID_WEB_Switchoff2_file_Nr3", SwitchoffFile),
        221: ("ID_WEB_Switchoff2_file_Nr4", SwitchoffFile),
        222: ("ID_WEB_Switchoff2_file_Time0", Timestamp),
        223: ("ID_WEB_Switchoff2_file_Time1", Timestamp),
        224: ("ID_WEB_Switchoff2_file_Time2", Timestamp),
        225: ("ID_WEB_Switchoff2_file_Time3", Timestamp),
        226: ("ID_WEB_Switchoff2_file_Time4", Timestamp),
        227: ("ID_WEB_RBE_RT_Ist", Celsius),
        228: ("ID_WEB_RBE_RT_Soll", Celsius),
        229: ("ID_WEB_Temperatur_BW_oben", Celsius),
        230: ("ID_WEB_Code_WP_akt_2", Code_WP),
        231: ("ID_WEB_Freq_VD", Celsius),
    }

    def __init__(self, data):
        self._parse(data)

    def _parse(self, data):
        for i, d in enumerate(data):
            id, conv = self.calculations.get(i, (None, None))
            if not id:
                continue
            if i == 81:
                # Version string spans multiple bytes
                setattr(self, id, conv(i, data[i : i + 9]))
            elif i > 81 and i < 91:
                # skip other version bytes
                continue
            else:
                setattr(self, id, conv(i, d))

    def get(self, id):
        return getattr(self, id, None)
