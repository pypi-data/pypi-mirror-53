{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1936:function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return u});var r=n(1),o=n.n(r),a=n(1937),i=n.n(a);n(2129),n(2128);function u(t){return o.a.createElement(\"span\",{className:\"BootstrapSliderWrapper\"},o.a.createElement(i.a,t))}},2128:function(t,e,n){},2549:function(t,e,n){\"use strict\";n.d(e,\"b\",function(){return s}),n.d(e,\"a\",function(){return f}),n.d(e,\"c\",function(){return y});var r=n(2736),o=n(17),a=n(2550);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=.25,c={LAT_MIN:-90,LAT_MAX:90,LNG_MIN:-180,LNG_MAX:180};function l(t){var e=o.extent(t,function(t){return t[1]}),n=o.extent(t,function(t){return t[0]}),r=e[0]===e[1]?function(t){return[t[0]-u<c.LAT_MIN?c.LAT_MIN:t[0]-u,t[1]+u>c.LAT_MAX?c.LAT_MAX:t[1]+u]}(e):e,a=n[0]===n[1]?function(t){return[t[0]-u<c.LNG_MIN?c.LNG_MIN:t[0]-u,t[1]+u>c.LNG_MAX?c.LNG_MAX:t[1]+u]}(n):n;return[[a[0],r[0]],[a[1],r[1]]]}function s(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var o=l(e);return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){i(t,e,n[e])})}return t}({},t,Object(r.a)({height:t.height,width:t.width,padding:n,bounds:o}))}catch(e){return console.error(\"Could not auto zoom\",e),t}}function f(t,e,n,r){var o,i,u=t,c=n;return u.js_tooltip&&(c=Object(a.a)(u.js_tooltip)),c&&(o=function(t){t.picked?e({content:c(t),x:t.x,y:t.y+30}):e(null)}),u.js_onclick_href?i=function(t){var e=Object(a.a)(u.js_onclick_href)(t);window.open(e)}:u.table_filter&&void 0!==r&&(i=function(t){return r(t.object[u.line_column])}),{onClick:i,onHover:o,pickable:Boolean(o)}}var p={p1:.01,p5:.05,p95:.95,p99:.99};function y(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"sum\",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return\"count\"===e?function(t){return t.length}:(t=e in p?function(t,r){var a;return a=n?t.sort(function(t,e){return o.ascending(n(t),n(e))}):t.sort(o.ascending),o.quantile(a,p[e],r)}:o[e],n?function(e){return t(e.map(n))}:function(e){return t(e)})}},2550:function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return f});var r=n(2581),o=n.n(r),a=n(2582),i=n.n(a),u=n(17),c=n(2553);function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s={console:console,_:i.a,colors:c,d3array:u};function f(t,e,n){var r={},a=\"SAFE_EVAL_\"+Math.floor(1e6*Math.random());r[a]={};var i=a+\"=\"+t,u=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){l(t,e,n[e])})}return t}({},s,e);Object.keys(u).forEach(function(t){r[t]=u[t]});try{return o.a.runInNewContext(i,r,n),r[a]}catch(t){return function(){return t}}}},2553:function(t,e,n){\"use strict\";n.r(e),n.d(e,\"hexToRGB\",function(){return o});var r=n(62);function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:255;if(!t)return[0,0,0,e];var n=Object(r.f)(t);return[n.r,n.g,n.b,e]}},2557:function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return O});var r=n(226),o=n.n(r),a=n(1),i=n.n(a),u=n(0),c=n.n(u),l=n(2576),s=n(2558);n(2577),n(2566);function f(t){return(f=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){b(t,e,n[e])})}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}var g=2e3,w={viewport:c.a.object.isRequired,layers:c.a.array.isRequired,setControlValue:c.a.func,mapStyle:c.a.string,mapboxApiAccessToken:c.a.string.isRequired,onViewportChange:c.a.func},O=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),r=this,(n=!(o=h(e).call(this,t))||\"object\"!==f(o)&&\"function\"!=typeof o?v(r):o).tick=n.tick.bind(v(v(n))),n.onViewportChange=n.onViewportChange.bind(v(v(n))),n.state={previousViewport:t.viewport,timer:setInterval(n.tick,g)},n}var n,r,a;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(e,i.a.Component),n=e,a=[{key:\"getDerivedStateFromProps\",value:function(t,e){return t.viewport!==e.viewport?{viewport:y({},t.viewport),previousViewport:e.viewport}:null}}],(r=[{key:\"componentWillUnmount\",value:function(){clearInterval(this.state.timer)}},{key:\"onViewportChange\",value:function(t){var e=Object.assign({},t),n=y({},this.state.previousViewport,e);this.props.onViewportChange(n)}},{key:\"tick\",value:function(){var t=this;if(this.state&&!o()(this.state.previousViewport,this.props.viewport)){var e=this.props.setControlValue,n=this.props.viewport;e&&e(\"viewport\",n),this.setState(function(){return{previousViewport:t.props.viewport}})}}},{key:\"layers\",value:function(){return this.props.layers.some(function(t){return\"function\"==typeof t})?this.props.layers.map(function(t){return\"function\"==typeof t?t():t}):this.props.layers}},{key:\"render\",value:function(){var t=this.props.viewport;return i.a.createElement(l.b,p({},t,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),i.a.createElement(s.i,p({},t,{layers:this.layers(),initWebGLParameters:!0})))}}])&&d(n.prototype,r),a&&d(n,a),e}();O.propTypes=w,O.defaultProps={mapStyle:\"light\",onViewportChange:function(){},setControlValue:function(){}}},2560:function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return y});var r=n(1),o=n.n(r),a=n(0),i=n.n(a);function u(t){return(u=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||\"object\"!==u(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p={label:i.a.string.isRequired,value:i.a.string.isRequired},y=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),l(this,s(e).apply(this,arguments))}var n,r,a;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(e,o.a.PureComponent),n=e,(r=[{key:\"render\",value:function(){return o.a.createElement(\"div\",null,this.props.label,o.a.createElement(\"strong\",null,this.props.value))}}])&&c(n.prototype,r),a&&c(n,a),e}();y.propTypes=p},2566:function(t,e,n){},2567:function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return c});var r=n(8),o=n.n(r);function a(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}var i=[1,0,1,0,0,0,0];function u(t,e){var n=parseInt(o()(e).format(\"x\"),10);return parseInt(o()(e).add(t).format(\"x\"),10)-n}var c=function(t,e){var n,r,c=o()(Math.min.apply(Math,a(t))),l=o()(Math.max.apply(Math,a(t)));if(-1!==e.indexOf(\"/\")){var s=e.split(\"/\",2);s[0].endsWith(\"Z\")?(r=o()(s[0]),n=o.a.duration(s[1])):(r=o()(s[1]),n=o.a.duration(s[0]))}else r=function(t,e){var n=o()(t).subtract(e),r=t.toArray(),a=n.toArray(),u=r.map(function(t,e){return a[e]!==t}).indexOf(!0),c=r.map(function(t,e){if(e===u){var n=t-a[e];return t-(t-i[e])%n}return e<u||-1===u?t:i[e]});return o()(c)}(c,n=o.a.duration(e));for(var f=o()(r);f<c;)f.add(n);for(;f>c;)f.subtract(n);for(var p=o()(r);p>l;)p.subtract(n);for(;p<l;)p.add(n);var y=null!=e?[f,o()(f).add(n)]:[f,p],b=t.every(function(t){return null===t});return{start:parseInt(f.format(\"x\"),10),end:parseInt(p.format(\"x\"),10),getStep:u.bind(this,n),values:y.map(function(t){return parseInt(t.format(\"x\"),10)}),disabled:b}}},2568:function(t,e,n){\"use strict\";var r=n(1),o=n.n(r),a=n(0),i=n.n(a),u=n(2557),c=n(1032),l=n.n(c),s=n(28),f=n(1936);n(2569);function p(t){return(p=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}var m={start:i.a.number.isRequired,step:i.a.number.isRequired,end:i.a.number.isRequired,values:i.a.array.isRequired,onChange:i.a.func,loopDuration:i.a.number,maxFrames:i.a.number,orientation:i.a.oneOf([\"horizontal\",\"vertical\"]),reversed:i.a.bool,disabled:i.a.bool,range:i.a.bool},v=function(t){function e(t){var n,r,o;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),r=this,(n=!(o=b(e).call(this,t))||\"object\"!==p(o)&&\"function\"!=typeof o?h(r):o).state={intervalId:null};var a=t.end-t.start,i=Math.min(t.maxFrames,a/t.step),u=a/i;return n.intervalMilliseconds=t.loopDuration/i,n.increment=u<t.step?t.step:u-u%t.step,n.onChange=n.onChange.bind(h(h(n))),n.play=n.play.bind(h(h(n))),n.pause=n.pause.bind(h(h(n))),n.stepBackward=n.stepBackward.bind(h(h(n))),n.stepForward=n.stepForward.bind(h(h(n))),n.getPlayClass=n.getPlayClass.bind(h(h(n))),n.formatter=n.formatter.bind(h(h(n))),n}var n,r,a;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,o.a.PureComponent),n=e,(r=[{key:\"componentDidMount\",value:function(){l.a.bind([\"space\"],this.play)}},{key:\"componentWillUnmount\",value:function(){l.a.unbind([\"space\"])}},{key:\"onChange\",value:function(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()}},{key:\"getPlayClass\",value:function(){return null==this.state.intervalId?\"fa fa-play fa-lg slider-button\":\"fa fa-pause fa-lg slider-button\"}},{key:\"play\",value:function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}}},{key:\"pause\",value:function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}},{key:\"stepForward\",value:function(){var t=this,e=this.props,n=e.start,r=e.end,o=e.step,a=e.values;if(!e.disabled){var i=(Array.isArray(a)?a:[a,a+o]).map(function(e){return e+t.increment}),u=i[1]>r?i[0]-n:0;this.props.onChange(i.map(function(t){return t-u}))}}},{key:\"stepBackward\",value:function(){var t=this,e=this.props,n=e.start,r=e.end,o=e.step,a=e.values;if(!e.disabled){var i=(Array.isArray(a)?a:[a,a+o]).map(function(e){return e-t.increment}),u=i[0]<n?r-i[1]:0;this.props.onChange(i.map(function(t){return t+u}))}}},{key:\"formatter\",value:function(t){if(this.props.disabled)return Object(s.b)(\"Data has no time steps\");var e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(function(t){return new Date(t).toUTCString()}).join(\" : \")}},{key:\"render\",value:function(){var t=this.props,e=t.start,n=t.end,r=t.step,a=t.orientation,i=t.reversed,u=t.disabled,c=t.range,l=t.values;return o.a.createElement(\"div\",{className:\"play-slider\"},o.a.createElement(\"div\",{className:\"play-slider-controls padded\"},o.a.createElement(\"i\",{className:\"fa fa-step-backward fa-lg slider-button \",onClick:this.stepBackward}),o.a.createElement(\"i\",{className:this.getPlayClass(),onClick:this.play}),o.a.createElement(\"i\",{className:\"fa fa-step-forward fa-lg slider-button \",onClick:this.stepForward})),o.a.createElement(\"div\",{className:\"play-slider-scrobbler padded\"},o.a.createElement(f.a,{value:c?l:l[0],range:c,formatter:this.formatter,change:this.onChange,min:e,max:n,step:r,orientation:a,reversed:i,disabled:u?\"disabled\":\"enabled\"})))}}])&&y(n.prototype,r),a&&y(n,a),e}();function g(t){return(g=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){O(t,e,n[e])})}return t}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function C(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}v.propTypes=m,v.defaultProps={onChange:function(){},loopDuration:15e3,maxFrames:100,orientation:\"horizontal\",reversed:!1,disabled:!1,range:!0},n.d(e,\"a\",function(){return P});var k={getLayers:i.a.func.isRequired,start:i.a.number.isRequired,end:i.a.number.isRequired,getStep:i.a.func,values:i.a.array.isRequired,aggregation:i.a.bool,disabled:i.a.bool,viewport:i.a.object.isRequired,children:i.a.node,mapStyle:i.a.string,mapboxApiAccessToken:i.a.string.isRequired,setControlValue:i.a.func,onViewportChange:i.a.func,onValuesChange:i.a.func},P=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),r=this,(n=!(o=j(e).call(this,t))||\"object\"!==g(o)&&\"function\"!=typeof o?C(r):o).onViewportChange=n.onViewportChange.bind(C(C(n))),n}var n,r,a;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(e,o.a.Component),n=e,(r=[{key:\"onViewportChange\",value:function(t){var e=this.props.disabled?w({},t):w({},t,{height:t.height+20});this.props.onViewportChange(e)}},{key:\"render\",value:function(){var t=this.props,e=t.start,n=t.end,r=t.getStep,a=t.disabled,i=t.aggregation,c=t.children,l=t.getLayers,s=t.values,f=t.onValuesChange,p=t.viewport,y=t.setControlValue,b=t.mapStyle,d=t.mapboxApiAccessToken,h=l(s),m=w({},p,{height:a?p.height:p.height-20});return o.a.createElement(\"div\",null,o.a.createElement(u.a,{viewport:m,layers:h,setControlValue:y,mapStyle:b,mapboxApiAccessToken:d,onViewportChange:this.onViewportChange}),!a&&o.a.createElement(v,{start:e,end:n,step:r(e),values:s,range:!i,onChange:f}),c)}}])&&_(n.prototype,r),a&&_(n,a),e}();P.propTypes=k,P.defaultProps={aggregation:!1,disabled:!1,mapStyle:\"light\",setControlValue:function(){},onViewportChange:function(){},onValuesChange:function(){}}},2569:function(t,e,n){},2572:function(t,e,n){\"use strict\";n.d(e,\"a\",function(){return h});var r=n(1),o=n.n(r),a=n(0),i=n.n(a),u=n(529);n(2573);function c(t){return(c=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return!e||\"object\"!==c(e)&&\"function\"!=typeof e?function(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d={categories:i.a.object,toggleCategory:i.a.func,showSingleCategory:i.a.func,format:i.a.string,position:i.a.oneOf([null,\"tl\",\"tr\",\"bl\",\"br\"])},h=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),p(this,y(e).apply(this,arguments))}var n,r,a;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(e,o.a.PureComponent),n=e,(r=[{key:\"format\",value:function(t){if(!this.props.format)return t;var e=parseFloat(t);return Object(u.b)(this.props.format,e)}},{key:\"formatCategoryLabel\",value:function(t){if(!this.props.format)return t;if(t.includes(\" - \")){var e=t.split(\" - \");return this.format(e[0])+\" - \"+this.format(e[1])}return this.format(t)}},{key:\"render\",value:function(){var t,e=this;if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;var n=Object.entries(this.props.categories).map(function(t){var n=s(t,2),r=n[0],a=n[1],i={color:\"rgba(\"+a.color.join(\", \")+\")\"},u=a.enabled?\"◼\":\"◻\";return o.a.createElement(\"li\",{key:r},o.a.createElement(\"a\",{href:\"#\",onClick:function(){return e.props.toggleCategory(r)},onDoubleClick:function(){return e.props.showSingleCategory(r)}},o.a.createElement(\"span\",{style:i},u),\" \",e.formatCategoryLabel(r)))}),r=\"t\"===this.props.position.charAt(0)?\"top\":\"bottom\",a=\"r\"===this.props.position.charAt(1)?\"right\":\"left\",i=(l(t={position:\"absolute\"},r,\"0px\"),l(t,a,\"10px\"),t);return o.a.createElement(\"div\",{className:\"legend\",style:i},o.a.createElement(\"ul\",{className:\"categories\"},n))}}])&&f(n.prototype,r),a&&f(n,a),e}();h.propTypes=d,h.defaultProps={categories:{},toggleCategory:function(){},showSingleCategory:function(){},format:null,position:\"tr\"}},2573:function(t,e,n){},2578:function(t,e){},2579:function(t,e){},2580:function(t,e){},2671:function(t,e,n){\"use strict\";n.r(e);var r=n(1),o=n.n(r),a=n(0),i=n.n(a),u=n(2558),c=n(2568),l=n(2572),s=n(2560),f=n(17),p=n(139),y=n(296),b=n(837),d=n(2553);function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw a}}return n}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}var v=10;function g(t,e,n){var r=t.break_points,o=t.num_buckets;if(!e)return[];if(void 0===r||0===r.length){var a=o?parseInt(o,10):v,i=m(Object(f.extent)(e,n),2),u=i[0],c=i[1];if(void 0===u)return[];var l=(c-u)/a,s=0===l?0:Math.max(0,Math.ceil(Math.log10(1/l))),p=c>c.toFixed(s)?1:0;return Array(a+1+p).fill().map(function(t,e){return(u+e*l).toFixed(s)})}return r.sort(function(t,e){return parseFloat(t)-parseFloat(e)})}function w(t,e,n){var r,o,a=t.break_points,i=t.num_buckets,u=t.linear_color_scheme,c=t.opacity,l=a||i?g({break_points:a,num_buckets:i},e,n):null,s=Array.isArray(u)?new y.a({id:\"custom\",colors:u}):Object(b.a)().get(u);if(null!==l){var h=l.length-1,m=h>1?s.getColors(h):[s.colors[s.colors.length-1]],v=m[0],w=m[m.length-1];m.unshift(v),m.push(w);var O=l.map(function(t){return parseFloat(t)});r=Object(p.i)().domain(O).range(m),o=function(t){return t>l[h]||t<l[0]}}else r=s.createLinearScale(Object(f.extent)(e,n)),o=function(){return!1};return function(t){var e=n(t),a=Object(d.hexToRGB)(r(e));return o(e)?a[3]=0:a[3]=c/100*255,a}}var O=n(2549),_=n(2567),j=n(2550);function S(t){return(S=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&\"function\"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?\"symbol\":typeof t})(t)}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){if(void 0===t)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return t}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}n.d(e,\"getLayer\",function(){return V});function V(t,e,n,r,a,i,c){var l=t,f=l.fill_color_picker,p=l.stroke_color_picker,y=x(e.data.features);if(null!=c&&c.forEach(function(t){y=y.filter(t)}),l.js_data_mutator){var b=Object(j.a)(l.js_data_mutator);y=b(y)}var d=l.metric?l.metric.label||l.metric:null,h=null===l.metric?function(){return[f.r,f.g,f.b,255*f.a]}:w(l,y,function(t){return t[d]}),m=function(t){var e=h(t);return a.length>0&&-1===a.indexOf(t[l.line_column])&&(e[3]/=2),e},v=l.line_column&&l.metric&&[\"geohash\",\"zipcode\"].indexOf(l.line_type)>=0?function(t){return function(e){var n=t.metric.label||t.metric;return o.a.createElement(\"div\",{className:\"deckgl-tooltip\"},o.a.createElement(s.a,{label:\"\".concat(t.line_column,\": \"),value:\"\".concat(e.object[t.line_column])}),t.metric&&o.a.createElement(s.a,{label:\"\".concat(n,\": \"),value:\"\".concat(e.object[n])}))}}(l):void 0;return new u.f(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){E(t,e,n[e])})}return t}({id:\"path-layer-\".concat(l.slice_id),data:y,pickable:!0,filled:l.filled,stroked:l.stroked,getPolygon:function(t){return t.polygon},getFillColor:m,getLineColor:[p.r,p.g,p.b,255*p.a],getLineWidth:l.line_width,extruded:l.extruded,getElevation:function(t){return function(t,e){return 0===e(t)[3]?0:t.elevation}(t,m)},elevationScale:l.multiplier,fp64:!0},Object(O.a)(l,r,v,i)))}var T={formData:i.a.object.isRequired,payload:i.a.object.isRequired,setControlValue:i.a.func.isRequired,viewport:i.a.object.isRequired,onAddFilter:i.a.func,setTooltip:i.a.func},I=function(t){function e(t){var n,r,o;return function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,e),r=this,(n=!(o=k(e).call(this,t))||\"object\"!==S(o)&&\"function\"!=typeof o?A(r):o).state=e.getDerivedStateFromProps(t),n.getLayers=n.getLayers.bind(A(A(n))),n.onSelect=n.onSelect.bind(A(A(n))),n.onValuesChange=n.onValuesChange.bind(A(A(n))),n.onViewportChange=n.onViewportChange.bind(A(A(n))),n}var n,r,a;return function(t,e){if(\"function\"!=typeof e&&null!==e)throw new TypeError(\"Super expression must either be null or a function\");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(e,o.a.Component),n=e,a=[{key:\"getDerivedStateFromProps\",value:function(t,e){if(e&&t.payload.form_data===e.formData)return null;var n=t.payload.data.features||[],r=n.map(function(t){return t.__timestamp}),o=t.payload.form_data.time_grain_sqla||t.payload.form_data.granularity||\"P1D\",a=Object(_.a)(r,o);return{start:a.start,end:a.end,getStep:a.getStep,values:a.values,disabled:a.disabled,viewport:t.formData.autozoom?Object(O.b)(t.viewport,function(t){return t.map(function(t){return t.polygon}).flat()}(n)):t.viewport,selected:[],lastClick:0,formData:t.payload.form_data}}}],(r=[{key:\"onSelect\",value:function(t){var e=this.props,n=e.formData,r=e.onAddFilter,o=new Date,a=o-this.state.lastClick<=250,i=x(this.state.selected);if(a)i.splice(0,i.length,t);else if(n.toggle_polygons){var u=i.indexOf(t);-1===u?i.push(t):i.splice(u,1)}else i.splice(0,1,t);this.setState({selected:i,lastClick:o}),n.table_filter&&r(n.line_column,i,!1,!0)}},{key:\"onValuesChange\",value:function(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})}},{key:\"onViewportChange\",value:function(t){this.setState({viewport:t})}},{key:\"getLayers\",value:function(t){if(void 0===this.props.payload.data.features)return[];var e=[];return t[0]===t[1]||t[1]===this.end?e.push(function(e){return e.__timestamp>=t[0]&&e.__timestamp<=t[1]}):e.push(function(e){return e.__timestamp>=t[0]&&e.__timestamp<t[1]}),[V(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip,this.state.selected,this.onSelect,e)]}},{key:\"render\",value:function(){var t=this.props,e=t.payload,n=t.formData,r=t.setControlValue,a=this.state,i=a.start,u=a.end,s=a.getStep,f=a.values,p=a.disabled,y=a.viewport,b=n,d=b.metric?b.metric.label||b.metric:null,m=function(t,e,n){var r=g(t,e,n),o=w(t,e,n),a={};return r.slice(1).forEach(function(e,n){var i=r[n]+\" - \"+r[n+1],u=.5*(parseFloat(r[n])+parseFloat(r[n+1])),c=t.metric?t.metric.label||t.metric:null;a[i]={color:o(h({},c||t.metric,u)),enabled:!0}}),a}(n,e.data.features,function(t){return t[d]});return o.a.createElement(\"div\",{style:{position:\"relative\"}},o.a.createElement(c.a,{getLayers:this.getLayers,start:i,end:u,getStep:s,values:f,onValuesChange:this.onValuesChange,disabled:p,viewport:y,onViewportChange:this.onViewportChange,mapboxApiAccessToken:e.data.mapboxApiKey,mapStyle:n.mapbox_style,setControlValue:r,aggregation:!0},null!==n.metric&&o.a.createElement(l.a,{categories:m,position:n.legend_position,format:n.legend_format})))}}])&&C(n.prototype,r),a&&C(n,a),e}();I.propTypes=T,I.defaultProps={onAddFilter:function(){},setTooltip:function(){}};e.default=I}}]);","extractedComments":[]}