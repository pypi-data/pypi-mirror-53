# -*- coding: utf-8 -*-
import unittest
import json
from download_mapping import create_parser, main
from intelmq.lib.test import skip_internet


@skip_internet()
class TestDownloadMapping(unittest.TestCase):
    def test_download(self):
        parser = create_parser()
        args = parser.parse_args("")
        result = json.loads(main(args))
        self.assertGreater(len(result), 100)
        self.assertIsInstance(result, list)

    def test_download_identifier_expression(self):
        parser = create_parser()
        args = parser.parse_args('-e "^foobar$" -i foobar'.split(' '))
        result = json.loads(main(args))
        self.assertGreater(len(result), 100)
        self.assertIsInstance(result, list)
#        self.assertIn
